(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11152,        295]
NotebookOptionsPosition[     10760,        278]
NotebookOutlinePosition[     11093,        293]
CellTagsIndexPosition[     11050,        290]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"INIITIALIZE", " ", "PARAMETERS"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"alpha", " ", "=", " ", "0.5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"beta", " ", "=", " ", "1.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"delta", " ", "=", " ", "0.5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"katta", " ", "=", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qAvg", " ", "=", " ", "1.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eta", " ", "=", " ", "0.25"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"etaBar", " ", "=", " ", "0.5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"chi", " ", "=", " ", "0.1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uBar", " ", "=", " ", "1.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R", "=", "20"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T", " ", "=", " ", "100"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "AGENTS", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Number", " ", "of", " ", "firms"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", " ", "=", " ", "10.0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Number", " ", "of", " ", "consumers"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m", "=", " ", "100.0"}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.688817332985351*^9, 3.688817428957637*^9}, 
   3.6888175381216917`*^9, {3.68881772930121*^9, 3.688817757480753*^9}, {
   3.6888179263827543`*^9, 3.6888179267746353`*^9}, {3.688818278522007*^9, 
   3.688818286493835*^9}, {3.688894256519751*^9, 3.688894277426407*^9}, {
   3.688895121722485*^9, 3.688895176733292*^9}, {3.688895588697754*^9, 
   3.6888955938388557`*^9}, {3.688979336619645*^9, 3.688979348207329*^9}, {
   3.689308645367378*^9, 3.689308655477956*^9}, {3.689308752271391*^9, 
   3.6893087533545847`*^9}, {3.689309323328319*^9, 3.6893093290613117`*^9}, {
   3.689310233360383*^9, 3.6893103199380217`*^9}, {3.689409102832477*^9, 
   3.689409108754774*^9}, 3.6894091504900312`*^9, {3.689410573127993*^9, 
   3.6894105847985353`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "PRICING", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "market", " ", "share", " ", "of", " ", "the", " ", "specialized", " ", 
    "firm"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ms", "[", 
      RowBox[{"q0_", ",", " ", "qi_"}], "]"}], ":=", " ", 
     RowBox[{"q0", " ", "/", " ", 
      RowBox[{"Total", "[", "qi", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"markup", " ", "smart", " ", "components"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"etaSpec", "[", 
      RowBox[{
      "delta_", ",", " ", "etaSpecLag_", ",", " ", "q0_", ",", " ", "qi_", 
       ",", " ", "etaBar_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "delta"}], ")"}], "*", "etaSpecLag"}], " ", "+", 
      " ", 
      RowBox[{"delta", "*", 
       RowBox[{"ms", "[", 
        RowBox[{"q0", ",", "qi"}], "]"}], "*", "etaBar"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"price", " ", "of", " ", "specialist"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pSpec", "[", 
      RowBox[{"cs_", ",", "etaSpec_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "etaSpec"}], ")"}], "*", "cs"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"price", " ", "charged", " ", "by", " ", "the", " ", "firm"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pFirm", "[", 
      RowBox[{"c_", ",", "eta_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "eta"}], ")"}], "*", "c"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "price", " ", "of", " ", "firm", " ", "if", " ", "it", " ", "produces", 
     " ", "the", " ", "smart", " ", "component"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pFirmSelf", "[", 
      RowBox[{"cSelf_", ",", "eta_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "eta"}], ")"}], "*", "cSelf"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "price", " ", "of", " ", "firm", " ", "if", " ", "it", " ", "produces", 
     " ", "the", " ", "smart", " ", "component"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pFirmSpec", "[", 
      RowBox[{"cSpec_", ",", "eta_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "eta"}], ")"}], "*", "cSpec"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.688817713338058*^9, 3.688817720292367*^9}, {
  3.6888177669722843`*^9, 3.688817771893434*^9}, {3.688818562138175*^9, 
  3.6888186326868143`*^9}, {3.6888186768178463`*^9, 3.688818685292778*^9}, {
  3.688893718705276*^9, 3.688893780901816*^9}, {3.688893818711969*^9, 
  3.688893856508936*^9}, {3.6888940881108723`*^9, 3.688894155707135*^9}, {
  3.688894219972365*^9, 3.688894243350931*^9}, {3.688894476127722*^9, 
  3.6888945201683064`*^9}, {3.688894554777959*^9, 3.688894766182043*^9}, {
  3.688894822157094*^9, 3.688894952864538*^9}, {3.688895583630715*^9, 
  3.688895600876688*^9}, {3.688895840768935*^9, 3.68889585276947*^9}, {
  3.688895957573781*^9, 3.688895962122137*^9}, {3.688897541519435*^9, 
  3.68889760425336*^9}, {3.6893093390769*^9, 3.689309346836534*^9}, {
  3.689409086973669*^9, 3.689409147187458*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"MARGINAL", " ", "COSTS"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Marginal", " ", "costs", " ", "of", " ", "the", " ", "\"\<usual\>\"", " ",
     "component"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"cp", " ", "=", " ", "20.0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Marginal", " ", "costs", " ", "of", " ", "the", " ", "smart", " ", 
     "component"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cs", " ", "=", " ", "10.0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Marginal", " ", "costs", " ", "if", " ", "firm", " ", "buys", " ", 
     "smart", " ", "component", " ", "from", " ", "specialist"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cSelf", "[", 
      RowBox[{"cp_", ",", " ", "cs_"}], "]"}], ":=", 
     RowBox[{"cp", " ", "+", " ", "cs"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Marginal", " ", "cost", " ", "if", " ", "firm", " ", "buys", " ", 
     "smart", " ", "component", " ", "from", " ", "specialist"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cSpec", "[", 
      RowBox[{"cp_", ",", "cs_", ",", " ", "etaSpec_"}], "]"}], ":=", 
     RowBox[{"cp", " ", "+", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "etaSpec"}], ")"}], "*", "cs"}]}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.688817452367639*^9, 3.688817489535553*^9}, 
   3.688817770412902*^9, 3.688818289711892*^9, {3.688893851007803*^9, 
   3.688893862323138*^9}, {3.6888938936917267`*^9, 3.688894041483673*^9}, {
   3.688894106808408*^9, 3.688894111401475*^9}, {3.688894204102118*^9, 
   3.688894213501877*^9}, {3.6888944200601673`*^9, 3.688894420625445*^9}, 
   3.689322710490035*^9, {3.689409030348434*^9, 3.689409039418542*^9}, {
   3.6894090736782703`*^9, 3.68940907854538*^9}, 3.689409143963704*^9, 
   3.689409269603546*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "PROFIT", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"profit", "[", 
     RowBox[{"q_", ",", "p_", ",", "c_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"q", "*", "p"}], " ", "-", " ", 
     RowBox[{"c", "*", "q"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6894110097710867`*^9, 3.689411094759206*^9}, {
  3.6895874856882668`*^9, 3.689587486303214*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "QUALITY", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"quality", " ", "of", " ", "specialist"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"qualitySpec", "[", 
      RowBox[{"uBar_", ",", " ", "alpha_", ",", " ", "beta_", ",", "qSpec_"}],
       " ", "]"}], " ", ":=", 
     RowBox[{"uBar", "*", 
      RowBox[{"(", 
       RowBox[{"1", "+", " ", 
        RowBox[{"beta", "*", 
         RowBox[{"qSpec", "^", "alpha"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"quality", " ", "of", " ", "firm"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"qualityFirm", "[", 
      RowBox[{"uBar_", ",", " ", "alpha_", ",", " ", "beta_", ",", "qFirm_"}],
       " ", "]"}], " ", ":=", 
     RowBox[{"uBar", "*", 
      RowBox[{"(", 
       RowBox[{"1", "+", " ", 
        RowBox[{"beta", "*", 
         RowBox[{"qFirm", "^", "alpha"}]}]}], ")"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.688817703159343*^9, 3.688817710920865*^9}, {
   3.688817786518964*^9, 3.688817809558403*^9}, {3.688817866557239*^9, 
   3.688817876498383*^9}, 3.6888182121701803`*^9, 3.688818256700206*^9, 
   3.688818298872867*^9, {3.688894309178638*^9, 3.688894346574914*^9}, {
   3.688895204726164*^9, 3.688895205359726*^9}, {3.688895409672784*^9, 
   3.688895482071973*^9}, {3.689309371071361*^9, 3.689309385426545*^9}, {
   3.689309560247978*^9, 3.6893095621912394`*^9}, {3.689409019841366*^9, 
   3.689409024318737*^9}}]
},
WindowSize->{1600, 844},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.0 for Linux x86 (64-bit) (June 27, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2391, 53, 495, "Input"],
Cell[2952, 75, 3621, 93, 451, "Input"],
Cell[6576, 170, 2147, 52, 319, "Input"],
Cell[8726, 224, 420, 11, 55, "Input"],
Cell[9149, 237, 1607, 39, 165, "Input"]
}
]
*)

(* End of internal cache information *)
