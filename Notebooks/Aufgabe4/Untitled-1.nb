(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12962,        345]
NotebookOptionsPosition[     12573,        327]
NotebookOutlinePosition[     12916,        342]
CellTagsIndexPosition[     12873,        339]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"o", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"o", "<", "g"}], ",", "1", ",", "2", ",", "3"}], "]"}]}], "Input",
 CellChangeTimes->{{3.694195084591546*^9, 3.6941951442821765`*^9}}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{3.694195144998574*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"t", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", "\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{"sList", "[", 
       RowBox[{"[", "t", "]"}], "]"}], "=", " ", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.5", ",", "0.5"}], "}"}], "->", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], ",", "n"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{
      RowBox[{"sCheck", "[", 
       RowBox[{"[", "t", "]"}], "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{"sCheck", "[", 
       RowBox[{"[", "t", "]"}], "]"}], "=", " ", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.8", ",", "0.2"}], "}"}], "->", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], ",", "n"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sCheck", "[", 
            RowBox[{"[", 
             RowBox[{"t", ",", "n"}], "]"}], "]"}], "\[Equal]", "1"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"obsProfSelf", "=", "0"}], ";", "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{"obsProfSpec", "=", "0"}], ";", "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{"randFirms", "=", " ", 
            RowBox[{"RandomSample", "[", 
             RowBox[{
              RowBox[{"Range", "[", "n", "]"}], ",", "ln"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"aggFirmProf", "=", "0"}], ";"}], 
                "\[IndentingNewLine]", "\t\t", ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", "1", ",", "lt"}], "}"}]}], "]"}], ";"}], 
             "\[IndentingNewLine]", "\t\t", ",", 
             RowBox[{"{", 
              RowBox[{"z", ",", "1", ",", "ln"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"obsProfSelf", "=", 
            RowBox[{
             RowBox[{"obsProfSelf", "/", "ln"}], "*", "lt"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"obsProfSpec", "=", 
            RowBox[{
             RowBox[{"obsProfSpec", "/", "ln"}], "*", "lt"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"obsProfSelf", "!=", "obsProfSpec"}], ",", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"obsProfSelf", "<", "obsProfSpec"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"sList", "[", 
                   RowBox[{"[", 
                    RowBox[{"t", ",", "n"}], "]"}], "]"}], "=", "1"}], ";"}], 
                ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"sList", "[", 
                   RowBox[{"[", 
                    RowBox[{"t", ",", "n"}], "]"}], "]"}], "=", "0"}], 
                 ";"}]}], "]"}], ";"}], ",", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"sList", "[", 
                RowBox[{"[", 
                 RowBox[{"t", ",", "n"}], "]"}], "]"}], "=", 
               RowBox[{"sList", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"t", "-", "1"}], ",", "n"}], "]"}], "]"}]}], 
              ";"}]}], "]"}], ";"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"sList", "[", 
             RowBox[{"[", 
              RowBox[{"t", ",", "n"}], "]"}], "]"}], "=", 
            RowBox[{"sList", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"t", "-", "1"}], ",", "n"}], "]"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "\t\t", "]"}], ";"}], "\[IndentingNewLine]", 
       "\t\t", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";"}]}], "]"}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"t", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"sList", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "=", " ", 
        RowBox[{"RandomChoice", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.5", ",", "0.5"}], "}"}], "->", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], ",", "n"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"sCheck", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}], ",", 
      "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"sCheck", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "=", " ", 
        RowBox[{"RandomChoice", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.8", ",", "0.2"}], "}"}], "->", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], ",", "n"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"sCheck", "[", 
              RowBox[{"[", 
               RowBox[{"t", ",", "n"}], "]"}], "]"}], "\[Equal]", "1"}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{"obsProfSelf", "=", "0"}], ";", "\[IndentingNewLine]", 
             "\t\t", 
             RowBox[{"obsProfSpec", "=", "0"}], ";", "\[IndentingNewLine]", 
             "\t\t", 
             RowBox[{"obsCountSelf", "=", "0"}], ";", "\[IndentingNewLine]", 
             "\t\t", 
             RowBox[{"obsCountSpec", "=", "0"}], ";", "\[IndentingNewLine]", 
             "\t\t", 
             RowBox[{"randFirms", "=", " ", 
              RowBox[{"RandomSample", "[", 
               RowBox[{
                RowBox[{"Range", "[", "n", "]"}], ",", "ln"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{"Do", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"sList", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"t", "-", "lt"}], ",", 
                    RowBox[{"randFirms", "[", 
                    RowBox[{"[", "ln", "]"}], "]"}]}], "]"}], "]"}], 
                    "\[Equal]", "0"}], ",", "\[IndentingNewLine]", "\t\t", 
                    RowBox[{
                    RowBox[{"obsProfSelf", "=", 
                    RowBox[{"obsProfSelf", "+", 
                    RowBox[{"profitListFirm", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"t", "-", "lt"}], ",", 
                    RowBox[{"randFirms", "[", 
                    RowBox[{"[", "ln", "]"}], "]"}]}], "]"}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", "\t\t", 
                    RowBox[{"obsCountSelf", "=", 
                    RowBox[{"obsCountSelf", "+", "1"}]}], ";"}], ",", 
                    "\[IndentingNewLine]", "\t\t", 
                    RowBox[{
                    RowBox[{"obsProfSpec", "=", 
                    RowBox[{"obsProfSpec", "+", 
                    RowBox[{"profitListFirm", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"t", "-", "lt"}], ",", 
                    RowBox[{"randFirms", "[", 
                    RowBox[{"[", "ln", "]"}], "]"}]}], "]"}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", "\t\t", 
                    RowBox[{"obsCountSpec", "=", 
                    RowBox[{"obsCountSpec", "+", "1"}]}], ";"}]}], "]"}], 
                   ";"}], "\[IndentingNewLine]", "\t\t", ",", 
                  RowBox[{"{", 
                   RowBox[{"y", ",", "1", ",", "lt"}], "}"}]}], "]"}], ";"}], 
               "\[IndentingNewLine]", "\t\t", ",", 
               RowBox[{"{", 
                RowBox[{"z", ",", "1", ",", "ln"}], "}"}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"obsProfSelf", "=", 
              RowBox[{"obsProfSelf", "/", "obsCountSelf"}]}], ";", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"obsProfSpec", "=", 
              RowBox[{"obsProfSpec", "/", "obsCountSpec"}]}], ";", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"obsProfSelf", "!=", "obsProfSpec"}], ",", 
               "\[IndentingNewLine]", "\t\t", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"obsProfSelf", "<", "obsProfSpec"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"sList", "[", 
                    RowBox[{"[", 
                    RowBox[{"t", ",", "n"}], "]"}], "]"}], "=", "1"}], ";"}], 
                  ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"sList", "[", 
                    RowBox[{"[", 
                    RowBox[{"t", ",", "n"}], "]"}], "]"}], "=", "0"}], 
                   ";"}]}], "]"}], ";"}], ",", "\[IndentingNewLine]", "\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"sList", "[", 
                  RowBox[{"[", 
                   RowBox[{"t", ",", "n"}], "]"}], "]"}], "=", 
                 RowBox[{"sList", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"t", "-", "1"}], ",", "n"}], "]"}], "]"}]}], 
                ";"}]}], "]"}], ";"}], ",", "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"sList", "[", 
               RowBox[{"[", 
                RowBox[{"t", ",", "n"}], "]"}], "]"}], "=", 
              RowBox[{"sList", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"t", "-", "1"}], ",", "n"}], "]"}], "]"}]}], ";"}]}],
            "\[IndentingNewLine]", "\t\t", "]"}], ";"}], 
         "\[IndentingNewLine]", "\t\t", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";"}]}], "]"}], 
    ";"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "10"}], "}"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6941977520682974`*^9, 3.694197782659511*^9}}]
},
WindowSize->{681, 676},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
FrontEndVersion->"10.3 for Microsoft Windows (64-bit) (October 9, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 328, 8, 72, "Input"],
Cell[911, 32, 70, 1, 31, "Output"]
}, Open  ]],
Cell[996, 36, 4706, 123, 492, "Input"],
Cell[5705, 161, 6864, 164, 612, "Input"]
}
]
*)

(* End of internal cache information *)

