(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     29544,        788]
NotebookOptionsPosition[     29309,        775]
NotebookOutlinePosition[     29643,        790]
CellTagsIndexPosition[     29600,        787]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"LOAD", " ", "FUNCTIONS"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "MyFunctions`"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"-", " ", 
                    RowBox[{"(*", 
                    RowBox[{"FIXED", " ", 
                    RowBox[{"STRATEGIES", ":", " ", 
                    RowBox[{
                    "ALL", " ", "FIRMS", " ", "BUY", " ", "SMART", " ", 
                    "COMPONENT"}]}]}], "*)"}], " ", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
   "*)"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"INIITIALIZE", " ", "PARAMETERS"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"alpha", "=", "0.5"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"beta", "=", "1.0"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"delta", "=", "0.5"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"katta", "=", "5"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"qAvg", "=", "1.0"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"eta", "=", "0.25"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"etaBar", "=", "0.5"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"chi", "=", "0.1"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"uBar", "=", "1.0"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"cp", "=", "20.0"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"cs", "=", "10.0"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Number", " ", "of", " ", "firms"}], "*)"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"n", "=", "10"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "A", " ", "dummy", " ", "vector", " ", "used", " ", "to", " ", "identify",
      " ", "each", " ", "firm", " ", "by", " ", "a", " ", "certain", " ", 
     RowBox[{"number", ":", 
      RowBox[{"1", "-", 
       RowBox[{"first", " ", "firm"}]}]}]}], ",", 
    RowBox[{"2", "-", 
     RowBox[{"second", " ", "firm"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"...", ".."}], "n"}], "-", 
     RowBox[{"nth", " ", "firm"}]}]}], "*)"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"Id", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"i", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Number", " ", "of", " ", "consumers"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"m", "=", "100"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Number", " ", "of", " ", "batch", " ", "runs"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"R", "=", "20"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Number", " ", "of", " ", "time", " ", "periods", " ", "per", " ", "batch",
     " ", "run"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"T", "=", "100"}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"Wanna", " ", "have", " ", 
    RowBox[{"plots", "?"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"plots", "=", "True"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Wanna", " ", "have", " ", 
    RowBox[{"tables", "?"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"tables", " ", "=", "True"}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
   "define", " ", "start", " ", "and", " ", "end", " ", "of", " ", "time", 
    " ", "period", " ", "you", " ", "want", " ", "to", " ", "consider"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"start", "=", "1"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"lend", "=", "10"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"length", " ", "of", " ", "table"}], "*)"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"pend", "=", "10"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"plot", " ", "horizon"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "firms", " ", "making", " ", "positive", " ", "profits", " ", "at", " ", 
    "T", " ", "for", " ", "each", " ", "batch", " ", "run"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"survivor", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0.0", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "1", ",", "R"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "how", " ", "many", " ", "firms", " ", "make", " ", "positive", " ", 
    "profits", " ", "at", " ", 
    RowBox[{"T", "?"}]}], "*)"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"numFirmsSurvive", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0.0", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "1", ",", "R"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"batch", " ", "runs"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"price", " ", "of", " ", "specialist"}], "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"priceSpec", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"prices", " ", "of", " ", "firms"}], "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"priceListFirm", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"0.0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "qualities", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{"qualityList", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"0.0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"quantities", " ", "produced", " ", "per", " ", "Period"}], 
       "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{"quantPeriodFirm", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"0.0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"quantPeriodSpec", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"aggregated", " ", "output"}], "*)"}], "\[IndentingNewLine]", 
      "\t", 
      RowBox[{"quantAggFirm", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"0.0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"quantAggSpec", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"market", " ", "share", " ", "of", " ", "specialist"}], "*)"}],
       "\[IndentingNewLine]", "\t", 
      RowBox[{"msSpec", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"markup", " ", "of", " ", "specialist"}], "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"markupSpec", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"profits", " ", "of", " ", "firms"}], "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"profitListFirm", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"0.0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"profit", " ", "of", " ", "specialist"}], "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"profitSpec", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"list", " ", "of", " ", "probabilities"}], "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"probList", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"0.0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", "PERIODS", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"compute", " ", "markup"}], "*)"}], "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"t", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"markupSpec", "[", 
             RowBox[{"[", "t", "]"}], "]"}], "=", "0.0"}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"markupSpec", "[", 
              RowBox[{"[", "t", "]"}], "]"}], "=", 
             RowBox[{"etaSpec", "[", 
              RowBox[{"delta", ",", 
               RowBox[{"markupSpec", "[", 
                RowBox[{"[", 
                 RowBox[{"t", "-", "1"}], "]"}], "]"}], ",", 
               RowBox[{"msSpec", "[", 
                RowBox[{"[", 
                 RowBox[{"t", "-", "1"}], "]"}], "]"}], ",", "etaBar"}], 
              "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", 
          RowBox[{"compute", " ", "price", " ", "of", " ", "specialist"}], 
          "*)"}], "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"priceSpec", "[", 
           RowBox[{"[", "t", "]"}], "]"}], "=", 
          RowBox[{"pSpec", "[", 
           RowBox[{"cs", ",", 
            RowBox[{"markupSpec", "[", 
             RowBox[{"[", "t", "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", 
          RowBox[{"compute", " ", "prices", " ", "of", " ", "firms"}], "*)"}],
          "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"priceListFirm", "[", 
           RowBox[{"[", "t", "]"}], "]"}], "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"pFirmSpec", "[", 
             RowBox[{
              RowBox[{"cSpec", "[", 
               RowBox[{"cp", ",", "cs", ",", 
                RowBox[{"markupSpec", "[", 
                 RowBox[{"[", "t", "]"}], "]"}]}], "]"}], ",", "eta"}], "]"}],
             ",", "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", 
          RowBox[{
          "compute", " ", "aggregated", " ", "quantities", " ", "for", " ", 
           "each", " ", "firm"}], "*)"}], "\[IndentingNewLine]", "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"t", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"quantAggFirm", "[", 
             RowBox[{"[", "t", "]"}], "]"}], "=", 
            RowBox[{"Table", "[", 
             RowBox[{"0.0", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"quantAggFirm", "[", 
             RowBox[{"[", "t", "]"}], "]"}], "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"quantAggFirm", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], "]"}], "+", 
               RowBox[{"quantPeriodFirm", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}], "]"}], 
         ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", 
          RowBox[{"compute", " ", "aggregated", " ", "output", " ", "of", " ", 
           RowBox[{"specialist", ":", 
            RowBox[{"In", " ", "the", " ", "initial", " ", "period", " ", 
             RowBox[{"(", 
              RowBox[{"t", "=", "1"}], ")"}], " ", "the", " ", "aggregated", 
             " ", "output", " ", "is", " ", 
             RowBox[{"zero", "!"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
         "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"t", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"quantAggSpec", "[", 
             RowBox[{"[", "t", "]"}], "]"}], "=", "0.0"}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"quantAggSpec", "[", 
             RowBox[{"[", "t", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"quantAggSpec", "[", 
              RowBox[{"[", 
               RowBox[{"t", "-", "1"}], "]"}], "]"}], "+", 
             RowBox[{"quantPeriodSpec", "[", 
              RowBox[{"[", 
               RowBox[{"t", "-", "1"}], "]"}], "]"}]}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", 
          RowBox[{
          "compute", " ", "quality", " ", "using", " ", "aggregated", " ", 
           "output", " ", "of", " ", "specialist"}], "*)"}], 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"qualityList", "[", 
           RowBox[{"[", "t", "]"}], "]"}], "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"qualitySpec", "[", 
             RowBox[{"uBar", ",", "alpha", ",", "beta", ",", 
              RowBox[{"quantAggSpec", "[", 
               RowBox[{"[", "t", "]"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "\t\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", 
          RowBox[{
          "Compute", " ", "the", " ", "probabilities", " ", "using", " ", 
           "the", " ", "quality", " ", "of", " ", "the", " ", "specialits", 
           " ", "and", " ", "prices", " ", "of", " ", 
           RowBox[{"firms", "!"}]}], "*)"}], "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"probList", "[", 
           RowBox[{"[", "t", "]"}], "]"}], "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"probability", "[", 
             RowBox[{
              RowBox[{"priceListFirm", "[", 
               RowBox[{"[", "t", "]"}], "]"}], ",", 
              RowBox[{"qualityList", "[", 
               RowBox[{"[", "t", "]"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "\t\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", 
          RowBox[{"compute", " ", "demand"}], "*)"}], "\[IndentingNewLine]", 
         "\t\t", 
         RowBox[{"choiceListAll", "=", 
          RowBox[{"RandomChoice", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"probList", "[", 
              RowBox[{"[", "t", "]"}], "]"}], "\[Rule]", "Id"}], ",", "m"}], 
           "]"}]}], ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", 
          RowBox[{
          "compute", " ", "quantities", " ", "produced", " ", "by", " ", 
           "firms", " ", "in", " ", "period", " ", "t"}], "*)"}], 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"quantPeriodFirm", "[", 
           RowBox[{"[", "t", "]"}], "]"}], "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"Count", "[", 
             RowBox[{"choiceListAll", ",", "i"}], "]"}], ",", 
            "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", 
          RowBox[{
          "compute", " ", "quantities", " ", "produced", " ", "by", " ", 
           "specialist", " ", "in", " ", "period", " ", "t"}], "*)"}], 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"quantPeriodSpec", "[", 
           RowBox[{"[", "t", "]"}], "]"}], "=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"quantPeriodFirm", "[", 
             RowBox[{"[", 
              RowBox[{"t", ",", "i"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", 
          RowBox[{"compute", " ", "market", " ", "share"}], "*)"}], 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"msSpec", "[", 
           RowBox[{"[", "t", "]"}], "]"}], "=", 
          RowBox[{"ms", "[", 
           RowBox[{
            RowBox[{"quantPeriodSpec", "[", 
             RowBox[{"[", "t", "]"}], "]"}], ",", "quantPeriodFirm"}], 
           "]"}]}], ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", 
          RowBox[{"compute", " ", "profits"}], "*)"}], "\[IndentingNewLine]", 
         "\t\t", 
         RowBox[{
          RowBox[{"profitListFirm", "[", 
           RowBox[{"[", "t", "]"}], "]"}], "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"profit", "[", 
             RowBox[{
              RowBox[{"quantPeriodFirm", "[", 
               RowBox[{"[", 
                RowBox[{"t", ",", "i"}], "]"}], "]"}], ",", 
              RowBox[{"priceListFirm", "[", 
               RowBox[{"[", 
                RowBox[{"t", ",", "i"}], "]"}], "]"}], ",", 
              RowBox[{"cSpec", "[", 
               RowBox[{"cp", ",", "cs", ",", 
                RowBox[{"markupSpec", "[", 
                 RowBox[{"[", "t", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"profitSpec", "[", 
           RowBox[{"[", "t", "]"}], "]"}], "=", 
          RowBox[{"profit", "[", 
           RowBox[{
            RowBox[{"quantPeriodSpec", "[", 
             RowBox[{"[", "t", "]"}], "]"}], ",", 
            RowBox[{"priceSpec", "[", 
             RowBox[{"[", "t", "]"}], "]"}], ",", "cs"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", 
          RowBox[{"compute", " ", "statistic"}], "*)"}], 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"t", "\[Equal]", "T"}], ",", "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"numFirmsSurvive", "[", 
              RowBox[{"[", "r", "]"}], "]"}], "=", 
             RowBox[{"Count", "[", 
              RowBox[{
               RowBox[{"profitListFirm", "[", 
                RowBox[{"[", "t", "]"}], "]"}], ",", 
               RowBox[{"u_", "/;", 
                RowBox[{"u", ">", "0"}]}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{"survivor", "[", 
              RowBox[{"[", "r", "]"}], "]"}], "=", 
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"profitListFirm", "[", 
                RowBox[{"[", "t", "]"}], "]"}], ",", 
               RowBox[{"u_", "/;", 
                RowBox[{"u", ">", "0"}]}]}], "]"}]}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"{", 
         RowBox[{"t", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"r", ",", "1", ",", "R"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Load", " ", "Results"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"results1C", "=", 
   RowBox[{"NotebookOpen", "[", 
    RowBox[{"FindFile", "[", "\"\<results1C.nb\>\"", "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"SelectionMove", "[", 
   RowBox[{"results1C", ",", "All", ",", "Notebook"}], "]"}], ";", 
  RowBox[{"SelectionEvaluate", "[", "results1C", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.690534083515486*^9, 3.690534083522037*^9}, {
   3.69069638473475*^9, 3.690696508065105*^9}, {3.6906965490402393`*^9, 
   3.690696577299485*^9}, {3.6907013324419518`*^9, 3.6907013875510263`*^9}, 
   3.690701497588133*^9, {3.691246528322667*^9, 3.6912465290295267`*^9}, {
   3.691246947517084*^9, 3.6912469526893063`*^9}, {3.691314375970696*^9, 
   3.691314430988325*^9}, {3.691314517009716*^9, 3.691314681767911*^9}, {
   3.691315426135294*^9, 3.6913155670634537`*^9}, {3.691315620041163*^9, 
   3.69131563215184*^9}, {3.6913157054557877`*^9, 3.691315707019587*^9}, {
   3.691315741913039*^9, 3.6913157430607567`*^9}, {3.691315813969467*^9, 
   3.691315815702236*^9}, 3.6913159233381567`*^9, {3.6913159595643177`*^9, 
   3.691315977952766*^9}, {3.691316027727604*^9, 3.6913160296464787`*^9}, {
   3.691316162875642*^9, 3.6913161819105988`*^9}, {3.691316314878605*^9, 
   3.691316323816264*^9}, {3.6913164952554483`*^9, 3.691316501663671*^9}, {
   3.691334461665251*^9, 3.691334522334835*^9}}]
},
WindowSize->{1920, 1052},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
FrontEndVersion->"10.0 for Linux x86 (64-bit) (June 27, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 28747, 753, 2761, "Input"]
}
]
*)

(* End of internal cache information *)
