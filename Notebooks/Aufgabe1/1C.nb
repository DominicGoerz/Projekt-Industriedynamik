(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     49715,       1344]
NotebookOptionsPosition[     49405,       1328]
NotebookOutlinePosition[     49739,       1343]
CellTagsIndexPosition[     49696,       1340]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"LOAD", " ", "FUNCTIONS"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", 
   RowBox[{"FindFile", "[", "\"\<../MyFunctions.m\>\"", "]"}], "]"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"-", " ", 
                    RowBox[{"(*", 
                    RowBox[{"FIXED", " ", 
                    RowBox[{"STRATEGIES", ":", " ", 
                    RowBox[{
                    "ALL", " ", "FIRMS", " ", "BUY", " ", "SMART", " ", 
                    "COMPONENT"}]}]}], "*)"}], " ", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
   "*)"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"INIITIALIZE", " ", "PARAMETERS"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"\[Alpha]", "=", "0.5"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"\[Beta]", "=", "1.0"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"\[Delta]", "=", "0.5"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"\[Kappa]", "=", "5"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"\[Chi]", "=", "0.1"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"\[Eta]", "=", "0.25"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"etaBar", "=", "0.5"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"uBar", "=", "1.0"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"cp", "=", "20.0"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"cs", "=", "10.0"}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{"Number", " ", "of", " ", "firms"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"n", "=", "10"}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "A", " ", "dummy", " ", "vector", " ", "used", " ", "to", " ", "identify",
      " ", "each", " ", "firm", " ", "by", " ", "a", " ", "certain", " ", 
     RowBox[{"number", ":", 
      RowBox[{"1", "-", 
       RowBox[{"first", " ", "firm"}]}]}]}], ",", 
    RowBox[{"2", "-", 
     RowBox[{"second", " ", "firm"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"...", ".."}], "n"}], "-", 
     RowBox[{"nth", " ", "firm"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"Id", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"i", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Number", " ", "of", " ", "consumers"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"m", "=", "100"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Number", " ", "of", " ", "batch", " ", "runs"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"R", "=", "20"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Number", " ", "of", " ", "time", " ", "periods", " ", "per", " ", "batch",
     " ", "run"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"T", "=", "100"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Wanna", " ", "have", " ", 
    RowBox[{"plots", "?"}]}], "*)"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"plots", "=", "True"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Wanna", " ", "have", " ", 
    RowBox[{"tables", "?"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"tables", " ", "=", "True"}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "define", " ", "start", " ", "and", " ", "end", " ", "of", " ", "time", 
    " ", "period", " ", "you", " ", "want", " ", "to", " ", "consider"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"start", "=", "1"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"lend", "=", "10"}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{"length", " ", "of", " ", "table"}], "*)"}], "\n", "\t", 
   RowBox[{"pend", "=", "10"}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{"plot", " ", "horizon"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "firms", " ", "making", " ", "positive", " ", "profits", " ", "at", " ", 
     "T", " ", "for", " ", "each", " ", "batch", " ", "run"}], "*)"}], 
   "\[IndentingNewLine]", "\t", 
   RowBox[{"survivor", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0.0", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "1", ",", "R"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "how", " ", "many", " ", "firms", " ", "make", " ", "positive", " ", 
    "profits", " ", "at", " ", 
    RowBox[{"T", "?"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"numFirmsSurvive", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0.0", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "1", ",", "R"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "average", " ", "profits", " ", "for", " ", "each", " ", "batch", " ", 
    "run"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"avgProfits", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"0.0", ",", 
        RowBox[{"{", 
         RowBox[{"firm", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "1", ",", "R"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"long", " ", "run", " ", "profits"}], "*)"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"longrunProfits", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"0.0", ",", 
        RowBox[{"{", 
         RowBox[{"firm", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "1", ",", "R"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"-", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"MAIN", "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], 
                   "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Timing", "[", "\n", 
   RowBox[{"(*", 
    RowBox[{"BATCH", " ", "RUNS"}], "*)"}], "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"-", "INITIALIZE"}]}]}], " ", "LISTS", " ", "FOR", " ", 
        "EACH", " ", "BATCH", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"RUN", "--"}], "--"}], "--"}]}], "-"}], "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}], "*)"}], "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", "prices", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"priceSpec", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"priceListFirm", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"quantities", " ", "produced", " ", "per", " ", "Period"}], 
        "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{"quantPeriodFirm", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"quantPeriodSpec", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", "qualities", "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{"qualityList", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"aggregated", " ", "output"}], "*)"}], "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"quantAggFirm", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"quantAggSpec", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", "profits", "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{"profitListFirm", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"profitSpec", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"market", " ", "share", " ", "of", " ", "specialist"}], 
        "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{"msSpec", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"markup", " ", "of", " ", "specialist"}], "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"\[Eta]Spec", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"list", " ", "of", " ", "probabilities"}], "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"probList", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}], "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"-", "FIRST"}]}]}]}]}]}]}]}]}]}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"PERIOD", "--"}], "--"}], "--"}], "--"}], "--"}], 
              "--"}], "--"}], "--"}], "--"}]}], "-"}], "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}], "*)"}], "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
       RowBox[{"t", "=", "1"}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"quantAggFirm", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"firm", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"quantAggSpec", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "=", "0.0"}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"\[Eta]Spec", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "=", "0.0"}], ";", 
       "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"compute", " ", "price", " ", "of", " ", "specialist"}], 
        "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"priceSpec", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "=", 
        RowBox[{"PriceSpec", "[", 
         RowBox[{"cs", ",", 
          RowBox[{"\[Eta]Spec", "[", 
           RowBox[{"[", "t", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"compute", " ", "prices", " ", "of", " ", "firms"}], "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"priceListFirm", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
         RowBox[{
          RowBox[{"PriceFirmSpec", "[", 
           RowBox[{"cp", ",", "cs", ",", "\[Eta]", ",", 
            RowBox[{"\[Eta]Spec", "[", 
             RowBox[{"[", "t", "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"firm", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{
        "compute", " ", "quality", " ", "using", " ", "aggregated", " ", 
         "output", " ", "of", " ", "specialist"}], "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"qualityList", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
         RowBox[{
          RowBox[{"QualityFirmSpec", "[", 
           RowBox[{"uBar", ",", "\[Alpha]", ",", "\[Beta]", ",", 
            RowBox[{"quantAggSpec", "[", 
             RowBox[{"[", "t", "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\t\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"firm", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{
        "Compute", " ", "the", " ", "probabilities", " ", "using", " ", "the",
          " ", "quality", " ", "of", " ", "the", " ", "specialits", " ", 
         "and", " ", "prices", " ", "of", " ", 
         RowBox[{"firms", "!"}]}], "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"probList", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
         RowBox[{
          RowBox[{"Prob", "[", 
           RowBox[{"firm", ",", 
            RowBox[{"priceListFirm", "[", 
             RowBox[{"[", "t", "]"}], "]"}], ",", 
            RowBox[{"qualityList", "[", 
             RowBox[{"[", "t", "]"}], "]"}], ",", " ", "\[Kappa]", ",", 
            "\[Chi]"}], "]"}], ",", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"firm", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"compute", " ", "demand"}], "*)"}], "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"choices", "=", 
        RowBox[{"RandomChoice", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"probList", "[", 
            RowBox[{"[", "t", "]"}], "]"}], "\[Rule]", "Id"}], ",", "m"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{
        "compute", " ", "quantities", " ", "produced", " ", "by", " ", 
         "firms", " ", "in", " ", "period", " ", "t"}], "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"quantPeriodFirm", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t", 
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{"choices", ",", "firm"}], "]"}], ",", 
          "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"firm", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{
        "compute", " ", "quantities", " ", "produced", " ", "by", " ", 
         "specialist", " ", "in", " ", "period", " ", "t"}], "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"quantPeriodSpec", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"quantPeriodFirm", "[", 
           RowBox[{"[", 
            RowBox[{"t", ",", "firm"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"firm", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"compute", " ", "market", " ", "share"}], "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"msSpec", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "=", 
        RowBox[{"MarketShare", "[", 
         RowBox[{
          RowBox[{"quantPeriodSpec", "[", 
           RowBox[{"[", "t", "]"}], "]"}], ",", "quantPeriodFirm"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"compute", " ", "profits"}], "*)"}], "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{
        RowBox[{"profitListFirm", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
         RowBox[{
          RowBox[{"ProfitFirmSpec", "[", 
           RowBox[{
            RowBox[{"quantPeriodFirm", "[", 
             RowBox[{"[", 
              RowBox[{"t", ",", "firm"}], "]"}], "]"}], ",", "cp", ",", "cs", 
            ",", "\[Eta]", ",", 
            RowBox[{"\[Eta]Spec", "[", 
             RowBox[{"[", "t", "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"firm", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t\t", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}], "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", "PERIODS"}]}]}]}]}]}]}]}]}]}], " ", "2"}], 
         "-", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"T", "--"}], "--"}], "--"}], "--"}], "--"}], "--"}],
              "--"}], "--"}], "--"}], "--"}]}], "*)"}], "\[IndentingNewLine]",
        "\t", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}], "*)"}], "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", 
         RowBox[{
         "compute", " ", "aggregated", " ", "quantities", " ", "for", " ", 
          "each", " ", "firm"}], "*)"}], "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"quantAggFirm", "[", 
            RowBox[{"[", "t", "]"}], "]"}], "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"quantAggFirm", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"t", "-", "1"}], ",", "firm"}], "]"}], "]"}], "+", 
              RowBox[{"quantPeriodFirm", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"t", "-", "1"}], ",", "firm"}], "]"}], "]"}]}], ",", 
             "\[IndentingNewLine]", "\t\t\t\t\t\t", 
             RowBox[{"{", 
              RowBox[{"firm", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{
           "compute", " ", "aggregated", " ", "output", " ", "of", " ", 
            RowBox[{"specialist", ":", 
             RowBox[{"In", " ", "the", " ", "initial", " ", "period", " ", 
              RowBox[{"(", 
               RowBox[{"t", "=", "1"}], ")"}], " ", "the", " ", "aggregated", 
              " ", "output", " ", "is", " ", 
              RowBox[{"zero", "!"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{
           RowBox[{"quantAggSpec", "[", 
            RowBox[{"[", "t", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"quantAggSpec", "[", 
             RowBox[{"[", 
              RowBox[{"t", "-", "1"}], "]"}], "]"}], "+", 
            RowBox[{"quantPeriodSpec", "[", 
             RowBox[{"[", 
              RowBox[{"t", "-", "1"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{"compute", " ", "markup"}], "*)"}], "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{
           RowBox[{"\[Eta]Spec", "[", 
            RowBox[{"[", "t", "]"}], "]"}], "=", 
           RowBox[{"MarkupSpec", "[", 
            RowBox[{"\[Delta]", ",", 
             RowBox[{"\[Eta]Spec", "[", 
              RowBox[{"[", 
               RowBox[{"t", "-", "1"}], "]"}], "]"}], ",", 
             RowBox[{"msSpec", "[", 
              RowBox[{"[", 
               RowBox[{"t", "-", "1"}], "]"}], "]"}], ",", "etaBar"}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{"compute", " ", "price", " ", "of", " ", "specialist"}], 
           "*)"}], "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"priceSpec", "[", 
            RowBox[{"[", "t", "]"}], "]"}], "=", 
           RowBox[{"PriceSpec", "[", 
            RowBox[{"cs", ",", 
             RowBox[{"\[Eta]Spec", "[", 
              RowBox[{"[", "t", "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{"compute", " ", "prices", " ", "of", " ", "firms"}], 
           "*)"}], "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"priceListFirm", "[", 
            RowBox[{"[", "t", "]"}], "]"}], "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"PriceFirmSpec", "[", 
              RowBox[{"cp", ",", "cs", ",", "\[Eta]", ",", 
               RowBox[{"\[Eta]Spec", "[", 
                RowBox[{"[", "t", "]"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
             RowBox[{"{", 
              RowBox[{"firm", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{
           "compute", " ", "quality", " ", "using", " ", "aggregated", " ", 
            "output", " ", "of", " ", "specialist"}], "*)"}], 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"qualityList", "[", 
            RowBox[{"[", "t", "]"}], "]"}], "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"QualityFirmSpec", "[", 
              RowBox[{"uBar", ",", "\[Alpha]", ",", "\[Beta]", ",", 
               RowBox[{"quantAggSpec", "[", 
                RowBox[{"[", "t", "]"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", "\t\t\t\t\t\t", 
             RowBox[{"{", 
              RowBox[{"firm", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{
           "Compute", " ", "the", " ", "probabilities", " ", "using", " ", 
            "the", " ", "quality", " ", "of", " ", "the", " ", "specialits", 
            " ", "and", " ", "prices", " ", "of", " ", 
            RowBox[{"firms", "!"}]}], "*)"}], "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"probList", "[", 
            RowBox[{"[", "t", "]"}], "]"}], "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Prob", "[", 
              RowBox[{"firm", ",", " ", 
               RowBox[{"priceListFirm", "[", 
                RowBox[{"[", "t", "]"}], "]"}], ",", 
               RowBox[{"qualityList", "[", 
                RowBox[{"[", "t", "]"}], "]"}], ",", " ", "\[Kappa]", ",", 
               "\[Chi]"}], "]"}], ",", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
             
             RowBox[{"{", 
              RowBox[{"firm", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{"compute", " ", "demand"}], "*)"}], "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"choices", "=", 
           RowBox[{"RandomChoice", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"probList", "[", 
               RowBox[{"[", "t", "]"}], "]"}], "\[Rule]", "Id"}], ",", "m"}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{
           "compute", " ", "quantities", " ", "produced", " ", "by", " ", 
            "firms", " ", "in", " ", "period", " ", "t"}], "*)"}], 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"quantPeriodFirm", "[", 
            RowBox[{"[", "t", "]"}], "]"}], "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Count", "[", 
              RowBox[{"choices", ",", "firm"}], "]"}], ",", 
             "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t", 
             RowBox[{"{", 
              RowBox[{"firm", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{
           "compute", " ", "quantities", " ", "produced", " ", "by", " ", 
            "specialist", " ", "in", " ", "period", " ", "t"}], "*)"}], 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"quantPeriodSpec", "[", 
            RowBox[{"[", "t", "]"}], "]"}], "=", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"quantPeriodFirm", "[", 
              RowBox[{"[", 
               RowBox[{"t", ",", "firm"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"firm", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{"compute", " ", "market", " ", "share"}], "*)"}], 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"msSpec", "[", 
            RowBox[{"[", "t", "]"}], "]"}], "=", 
           RowBox[{"MarketShare", "[", 
            RowBox[{
             RowBox[{"quantPeriodSpec", "[", 
              RowBox[{"[", "t", "]"}], "]"}], ",", "quantPeriodFirm"}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{"compute", " ", "profits"}], "*)"}], "\[IndentingNewLine]",
           "\t\t", 
          RowBox[{
           RowBox[{"profitListFirm", "[", 
            RowBox[{"[", "t", "]"}], "]"}], "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"ProfitFirmSpec", "[", 
              RowBox[{
               RowBox[{"quantPeriodFirm", "[", 
                RowBox[{"[", 
                 RowBox[{"t", ",", "firm"}], "]"}], "]"}], ",", "cp", ",", 
               "cs", ",", "\[Eta]", ",", 
               RowBox[{"\[Eta]Spec", "[", 
                RowBox[{"[", "t", "]"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
             RowBox[{"{", 
              RowBox[{"firm", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{"compute", " ", "statistic"}], "*)"}], 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"t", "\[Equal]", "T"}], ",", "\[IndentingNewLine]", 
            "\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"numFirmsSurvive", "[", 
               RowBox[{"[", "r", "]"}], "]"}], "=", 
              RowBox[{"Count", "[", 
               RowBox[{
                RowBox[{"profitListFirm", "[", 
                 RowBox[{"[", "t", "]"}], "]"}], ",", 
                RowBox[{"u_", "/;", 
                 RowBox[{"u", ">", "0"}]}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"survivor", "[", 
               RowBox[{"[", "r", "]"}], "]"}], "=", 
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"profitListFirm", "[", 
                 RowBox[{"[", "t", "]"}], "]"}], ",", 
                RowBox[{"u_", "/;", 
                 RowBox[{"u", ">", "0"}]}]}], "]"}]}]}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"{", 
          RowBox[{"t", ",", "2", ",", "T"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"r", ",", "1", ",", "R"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", "LOAD"}]}]}]}]}]}]}]}]}]}], " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"RESULTS", "--"}], "--"}], "--"}], "--"}], "--"}], "--"}],
        "--"}], "--"}], "--"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"results1C", "=", 
   RowBox[{"NotebookOpen", "[", 
    RowBox[{"FindFile", "[", "\"\<results1C.nb\>\"", "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"SelectionMove", "[", 
   RowBox[{"results1C", ",", "All", ",", "Notebook"}], "]"}], ";", 
  RowBox[{"SelectionEvaluate", "[", "results1C", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.690534083515486*^9, 3.690534083522037*^9}, {
   3.69069638473475*^9, 3.690696508065105*^9}, {3.6906965490402393`*^9, 
   3.690696577299485*^9}, {3.6907013324419518`*^9, 3.6907013875510263`*^9}, 
   3.690701497588133*^9, {3.691246528322667*^9, 3.6912465290295267`*^9}, {
   3.691246947517084*^9, 3.6912469526893063`*^9}, {3.691314375970696*^9, 
   3.691314430988325*^9}, {3.691314517009716*^9, 3.691314681767911*^9}, {
   3.691315426135294*^9, 3.6913155670634537`*^9}, {3.691315620041163*^9, 
   3.69131563215184*^9}, {3.6913157054557877`*^9, 3.691315707019587*^9}, {
   3.691315741913039*^9, 3.6913157430607567`*^9}, {3.691315813969467*^9, 
   3.691315815702236*^9}, 3.6913159233381567`*^9, {3.6913159595643177`*^9, 
   3.691315977952766*^9}, {3.691316027727604*^9, 3.6913160296464787`*^9}, {
   3.691316162875642*^9, 3.6913161819105988`*^9}, {3.691316314878605*^9, 
   3.691316323816264*^9}, {3.6913164952554483`*^9, 3.691316501663671*^9}, {
   3.691334461665251*^9, 3.691334522334835*^9}, {3.692543621054324*^9, 
   3.692543651836282*^9}, {3.692543682233913*^9, 3.692543700775795*^9}, {
   3.692543736950025*^9, 3.69254374786654*^9}, {3.692543841036511*^9, 
   3.692544277932104*^9}, {3.692544319085322*^9, 3.6925443355127296`*^9}, {
   3.6925444028844557`*^9, 3.692544404077828*^9}, {3.692544455516416*^9, 
   3.692544461054957*^9}, {3.692544516315103*^9, 3.6925445487392797`*^9}, {
   3.6925445878155622`*^9, 3.6925446159794893`*^9}, {3.692544701624825*^9, 
   3.692544753216104*^9}, {3.692544857688694*^9, 3.692544940402275*^9}, {
   3.692544999117577*^9, 3.692545076451838*^9}, {3.6925451311401033`*^9, 
   3.692545266830666*^9}, {3.692545366825365*^9, 3.692545384713038*^9}, {
   3.692545418174103*^9, 3.692545442232891*^9}, {3.692545681392737*^9, 
   3.692545885734262*^9}, {3.692545960232759*^9, 3.692545969851039*^9}, {
   3.69259925052525*^9, 3.6925992723099203`*^9}, {3.6925993868543177`*^9, 
   3.692599387933774*^9}, {3.6926028856684628`*^9, 3.692602887294718*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.19199999999999994848565165739273652434`6.096876168683841", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{3.69254534539365*^9, 3.692545384898985*^9, 
  3.692545590540669*^9, 3.6925456666060867`*^9, 3.692545907897238*^9, 
  3.692599279559843*^9}]
}, Open  ]]
},
WindowSize->{1920, 1052},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
FrontEndVersion->"10.0 for Linux x86 (64-bit) (June 27, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 48508, 1294, 4213, "Input"],
Cell[49091, 1318, 298, 7, 32, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
