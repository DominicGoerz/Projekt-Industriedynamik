(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     35523,        943]
NotebookOptionsPosition[     35288,        930]
NotebookOutlinePosition[     35622,        945]
CellTagsIndexPosition[     35579,        942]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"LOAD", " ", "FUNCTIONS"}], "*)"}], "\n"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{"<<", "MyFunctions`"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", "FIXED"}]}], " ", 
    RowBox[{"STRATEGIES", ":", " ", 
     RowBox[{
      RowBox[{
      "First", " ", "half", " ", "of", " ", "firms", " ", "buys", " ", "the", 
       " ", "smart", " ", "part", " ", "while", " ", "the", " ", "other", " ",
        "half", " ", "produces", " ", "the", " ", "smart", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"part", " ", "!"}], "--"}], "--"}], "--"}], "--"}],
                "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
        "--"}]}], "-"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"INIITIALIZE", " ", "PARAMETERS"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"alpha", "=", "0.5"}], ";"}], 
  RowBox[{"(*", "0.5", "*)"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"beta", "=", "1.0"}], ";"}], 
  RowBox[{"(*", "1.0", "*)"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"delta", "=", "0.5"}], ";"}], " ", 
  RowBox[{"(*", "0.5", "*)"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"katta", "=", "0.09"}], ";"}], " ", 
  RowBox[{"(*", "5", "*)"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"eta", "=", "0.25"}], ";"}], 
  RowBox[{"(*", "0.25", "*)"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"etaBar", "=", "0.5"}], ";"}], 
  RowBox[{"(*", "0.5", "*)"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"chi", "=", "0.1"}], ";"}], " ", 
  RowBox[{"(*", "0.5", "*)"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"uBar", "=", "1.0"}], ";"}], 
  RowBox[{"(*", "1.0", "*)"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"cp", "=", "20.0"}], ";"}], 
  RowBox[{"(*", "20.0", "*)"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"cs", "=", "10.0"}], ";"}], " ", 
  RowBox[{"(*", "10", "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"Number", " ", "of", " ", "firms"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"n", "=", "10"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"d", "=", 
    RowBox[{"Round", "[", 
     RowBox[{"n", "/", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "A", " ", "dummy", " ", "vector", " ", "used", " ", "to", " ", "identify",
      " ", "each", " ", "firm", " ", "by", " ", "a", " ", "certain", " ", 
     RowBox[{"number", ":", 
      RowBox[{"1", "-", 
       RowBox[{"first", " ", "firm"}]}]}]}], ",", 
    RowBox[{"2", "-", 
     RowBox[{"second", " ", "firm"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"...", ".."}], "n"}], "-", 
     RowBox[{"nth", " ", "firm"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"Id", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"i", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"Number", " ", "of", " ", "consumers"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"m", "=", "100"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Number", " ", "of", " ", "bartch", " ", "runs"}], "*)"}]}], "\n", 

 RowBox[{"\t", 
  RowBox[{
   RowBox[{"R", "=", "30"}], ";", " ", 
   RowBox[{"(*", "20", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Number", " ", "of", " ", "time", " ", "periods"}], "*)"}], 
   "\[IndentingNewLine]", "\t", 
   RowBox[{"T", "=", "100"}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"Wanna", " ", "have", " ", 
    RowBox[{"plots", "?"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"plots", "=", "True"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Wanna", " ", "have", " ", 
    RowBox[{"tables", "?"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"tables", " ", "=", "True"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "define", " ", "start", " ", "and", " ", "end", " ", "of", " ", "time", 
    " ", "period", " ", "you", " ", "want", " ", "to", " ", "consider"}], 
   "*)"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"start", "=", "1"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"lend", "=", "20"}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{"length", " ", "of", " ", "table"}], "*)"}], "\n", "\t", 
   RowBox[{"pend", "=", "20"}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{"plot", " ", "horizon"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "firms", " ", "making", " ", "positive", " ", "profits", " ", "at", " ", 
     "T", " ", "for", " ", "each", " ", "batch", " ", "run"}], "*)"}], 
   "\[IndentingNewLine]", "\t", 
   RowBox[{"survivor", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0.0", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "1", ",", "R"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "how", " ", "many", " ", "firms", " ", "make", " ", "positive", " ", 
    "profits", " ", "at", " ", 
    RowBox[{"T", "?"}]}], "*)"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"numFirmsSurvive", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0.0", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "1", ",", "R"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"-", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"-", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"MAIN", " ", "--"}], "--"}], "--"}], 
                    "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "-", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"-", 
         RowBox[{"-", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"-", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"batch", " ", "runs"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", "prices", "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"priceListFirm", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"0.0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"priceSpec", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", 
       RowBox[{"period", " ", "quantities"}], "*)"}], "\[IndentingNewLine]", 
      "\t", 
      RowBox[{"quantPeriodFirm", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"0.0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"quantPeriodSpec", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", 
       RowBox[{"aggregated", " ", "quantities"}], "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"quantAggSpec", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"quantAggFirm", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"0.0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", 
       RowBox[{"market", " ", "share"}], "*)"}], "\[IndentingNewLine]", "\t", 
      
      RowBox[{"msSpec", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", "markup", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{"markupSpec", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", "quality", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{"qualityList", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"0.0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", "probabilities", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{"probList", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"0.0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", "profits", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{"profitListFirm", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"0.0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", "PERIODS", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{
        "compute", " ", "aggregated", " ", "quantities", " ", "for", " ", 
         "each", " ", "firm"}], "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"t", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"quantAggFirm", "[", 
             RowBox[{"[", "t", "]"}], "]"}], "=", 
            RowBox[{"Table", "[", 
             RowBox[{"0.0", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"quantAggFirm", "[", 
             RowBox[{"[", "t", "]"}], "]"}], "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"quantAggFirm", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], "]"}], "+", 
               RowBox[{"quantPeriodFirm", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}], "]"}], 
         ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", 
          RowBox[{
          "compute", " ", "aggregated", " ", "quantities", " ", "of", " ", 
           "specialist"}], "*)"}], "\[IndentingNewLine]", "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"t", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"quantAggSpec", "[", 
             RowBox[{"[", "t", "]"}], "]"}], "=", "0.0"}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"quantAggSpec", "[", 
             RowBox[{"[", "t", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"quantAggSpec", "[", 
              RowBox[{"[", 
               RowBox[{"t", "-", "1"}], "]"}], "]"}], "+", 
             RowBox[{"quantPeriodSpec", "[", 
              RowBox[{"[", 
               RowBox[{"t", "-", "1"}], "]"}], "]"}]}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", 
          RowBox[{"compute", " ", "markup"}], "*)"}], "\[IndentingNewLine]", 
         "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"t", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"markupSpec", "[", 
             RowBox[{"[", "t", "]"}], "]"}], "=", "0.0"}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"markupSpec", "[", 
             RowBox[{"[", "t", "]"}], "]"}], "=", 
            RowBox[{"etaSpec", "[", 
             RowBox[{"delta", ",", 
              RowBox[{"markupSpec", "[", 
               RowBox[{"[", 
                RowBox[{"t", "-", "1"}], "]"}], "]"}], ",", 
              RowBox[{"msSpec", "[", 
               RowBox[{"[", 
                RowBox[{"t", "-", "1"}], "]"}], "]"}], ",", "etaBar"}], 
             "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", 
          RowBox[{"compute", " ", "price", " ", "of", " ", "specialist"}], 
          "*)"}], "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"priceSpec", "[", 
           RowBox[{"[", "t", "]"}], "]"}], "=", 
          RowBox[{"pSpec", "[", 
           RowBox[{"cs", ",", 
            RowBox[{"markupSpec", "[", 
             RowBox[{"[", "t", "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", 
          RowBox[{"compute", " ", "prices"}], "*)"}], "\[IndentingNewLine]", 
         "\t\t", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"priceListFirm", "[", 
             RowBox[{"[", 
              RowBox[{"t", ",", "i"}], "]"}], "]"}], "=", 
            RowBox[{"pFirmSpec", "[", 
             RowBox[{
              RowBox[{"cSpec", "[", 
               RowBox[{"cp", ",", "cs", ",", 
                RowBox[{"markupSpec", "[", 
                 RowBox[{"[", "t", "]"}], "]"}]}], "]"}], ",", "eta"}], 
             "]"}]}], ",", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"priceListFirm", "[", 
             RowBox[{"[", 
              RowBox[{"t", ",", "i"}], "]"}], "]"}], "=", 
            RowBox[{"pFirmSelf", "[", 
             RowBox[{
              RowBox[{"cSelf", "[", 
               RowBox[{"cp", ",", "cs"}], "]"}], ",", "eta"}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"d", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", 
          RowBox[{"compute", " ", "qualities"}], "*)"}], 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"qualityList", "[", 
             RowBox[{"[", 
              RowBox[{"t", ",", "i"}], "]"}], "]"}], "=", 
            RowBox[{"qualitySpec", "[", 
             RowBox[{"uBar", ",", "alpha", ",", "beta", ",", 
              RowBox[{"quantAggSpec", "[", 
               RowBox[{"[", "t", "]"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"qualityList", "[", 
             RowBox[{"[", 
              RowBox[{"t", ",", "i"}], "]"}], "]"}], "=", 
            RowBox[{"qualityFirm", "[", 
             RowBox[{"uBar", ",", "alpha", ",", "beta", ",", 
              RowBox[{"quantAggFirm", "[", 
               RowBox[{"[", 
                RowBox[{"t", ",", "i"}], "]"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"d", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", 
          RowBox[{"compute", " ", "probabilities"}], "*)"}], 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"probList", "[", 
           RowBox[{"[", "t", "]"}], "]"}], "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"probability", "[", 
             RowBox[{
              RowBox[{"priceListFirm", "[", 
               RowBox[{"[", "t", "]"}], "]"}], ",", 
              RowBox[{"qualityList", "[", 
               RowBox[{"[", "t", "]"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "\t\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", 
          RowBox[{"compute", " ", "demand"}], "*)"}], "\[IndentingNewLine]", 
         "\t\t", 
         RowBox[{"choiceListAll", "=", 
          RowBox[{"RandomChoice", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"probList", "[", 
              RowBox[{"[", "t", "]"}], "]"}], "\[Rule]", "Id"}], ",", "m"}], 
           "]"}]}], ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", 
          RowBox[{"compute", " ", "period", " ", "output"}], "*)"}], 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"quantPeriodFirm", "[", 
           RowBox[{"[", "t", "]"}], "]"}], "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"Count", "[", 
             RowBox[{"choiceListAll", ",", "i"}], "]"}], ",", 
            "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"quantPeriodSpec", "[", 
           RowBox[{"[", "t", "]"}], "]"}], "=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"quantPeriodFirm", "[", 
             RowBox[{"[", 
              RowBox[{"t", ",", "i"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", 
          RowBox[{"compute", " ", "market", " ", "share"}], "*)"}], 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"msSpec", "[", 
           RowBox[{"[", "t", "]"}], "]"}], "=", 
          RowBox[{"ms", "[", 
           RowBox[{
            RowBox[{"quantPeriodSpec", "[", 
             RowBox[{"[", "t", "]"}], "]"}], ",", "quantPeriodFirm"}], 
           "]"}]}], ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", 
          RowBox[{"compute", " ", "profits"}], "*)"}], "\[IndentingNewLine]", 
         "\t\t", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"profitListFirm", "[", 
             RowBox[{"[", 
              RowBox[{"t", ",", "i"}], "]"}], "]"}], "=", 
            RowBox[{"profit", "[", 
             RowBox[{
              RowBox[{"quantPeriodFirm", "[", 
               RowBox[{"[", 
                RowBox[{"t", ",", "i"}], "]"}], "]"}], ",", 
              RowBox[{"priceListFirm", "[", 
               RowBox[{"[", 
                RowBox[{"t", ",", "i"}], "]"}], "]"}], ",", 
              RowBox[{"cSpec", "[", 
               RowBox[{"cp", ",", "cs", ",", 
                RowBox[{"markupSpec", "[", 
                 RowBox[{"[", "t", "]"}], "]"}]}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"profitListFirm", "[", 
             RowBox[{"[", 
              RowBox[{"t", ",", "i"}], "]"}], "]"}], "=", 
            RowBox[{"profit", "[", 
             RowBox[{
              RowBox[{"quantPeriodFirm", "[", 
               RowBox[{"[", 
                RowBox[{"t", ",", "i"}], "]"}], "]"}], ",", 
              RowBox[{"priceListFirm", "[", 
               RowBox[{"[", 
                RowBox[{"t", ",", "i"}], "]"}], "]"}], ",", 
              RowBox[{"cSelf", "[", 
               RowBox[{"cp", ",", "cs"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"d", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", 
          RowBox[{"compute", " ", "statistic"}], "*)"}], 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"t", "\[Equal]", "T"}], ",", "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"numFirmsSurvive", "[", 
              RowBox[{"[", "r", "]"}], "]"}], "=", 
             RowBox[{"Count", "[", 
              RowBox[{
               RowBox[{"profitListFirm", "[", 
                RowBox[{"[", "t", "]"}], "]"}], ",", 
               RowBox[{"u_", "/;", 
                RowBox[{"u", ">", "0"}]}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{"survivor", "[", 
              RowBox[{"[", "r", "]"}], "]"}], "=", 
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"profitListFirm", "[", 
                RowBox[{"[", "t", "]"}], "]"}], ",", 
               RowBox[{"u_", "/;", 
                RowBox[{"u", ">", "0"}]}]}], "]"}]}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"t", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"r", ",", "1", ",", "R"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Load", " ", "Results"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"results1B", "=", 
   RowBox[{"NotebookOpen", "[", 
    RowBox[{"FindFile", "[", "\"\<results1B.nb\>\"", "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"SelectionMove", "[", 
   RowBox[{"results1B", ",", "All", ",", "Notebook"}], "]"}], ";", 
  RowBox[{"SelectionEvaluate", "[", "results1B", "]"}]}]}], "Input",
 CellChangeTimes->{{3.690534047656938*^9, 3.690534047661303*^9}, 
   3.690699983118863*^9, {3.690700017760223*^9, 3.690700069943945*^9}, {
   3.690700338860899*^9, 3.6907003614554157`*^9}, {3.690700476560109*^9, 
   3.690700523494061*^9}, 3.690700716772827*^9, 3.690700791039661*^9, {
   3.690700851583761*^9, 3.690700868294778*^9}, {3.690700956526722*^9, 
   3.690700984328312*^9}, {3.690701015425622*^9, 3.6907010703560057`*^9}, {
   3.691246187460534*^9, 3.691246188172669*^9}, {3.691246809713402*^9, 
   3.691246809859095*^9}, {3.691246890517591*^9, 3.691246891701644*^9}, {
   3.691296762931116*^9, 3.69129699249184*^9}, {3.6912970257407913`*^9, 
   3.6912971239385767`*^9}, {3.69129729332128*^9, 3.691297366414281*^9}, {
   3.691297601683998*^9, 3.691297620832473*^9}, 3.6912979049910297`*^9, {
   3.691297936193959*^9, 3.691297960257174*^9}, {3.691298027841878*^9, 
   3.691298113921686*^9}, {3.691298166018724*^9, 3.6912982566516237`*^9}, {
   3.691298313481855*^9, 3.691298342690858*^9}, {3.691298456796319*^9, 
   3.691298602954219*^9}, {3.691315762056528*^9, 3.691315762583529*^9}, 
   3.691315855043695*^9, {3.691315891907493*^9, 3.691315911729705*^9}, 
   3.69131602025391*^9, {3.691316053606909*^9, 3.691316151109002*^9}, {
   3.691316206387377*^9, 3.6913162482892027`*^9}, {3.691316408575931*^9, 
   3.691316418296173*^9}, {3.691334139693364*^9, 3.6913341528794403`*^9}, {
   3.6913341915740643`*^9, 3.691334231475933*^9}, {3.691334261747781*^9, 
   3.6913342801565723`*^9}, {3.691335799200159*^9, 3.6913359275498667`*^9}, {
   3.691335965385607*^9, 3.691335967636325*^9}, {3.691336007990614*^9, 
   3.6913360086354856`*^9}, {3.691336058723813*^9, 3.691336058913426*^9}, {
   3.6913361075518713`*^9, 3.691336109372498*^9}, {3.6913361711746893`*^9, 
   3.6913361934755697`*^9}, {3.691336252895183*^9, 3.691336359295199*^9}, {
   3.691336465278316*^9, 3.6913365056800737`*^9}, {3.691336558597044*^9, 
   3.691336574726509*^9}, {3.6913366171405697`*^9, 3.691336619363077*^9}, {
   3.691336674561841*^9, 3.6913366752717857`*^9}, {3.691336775173295*^9, 
   3.691336776138653*^9}, {3.691337357981628*^9, 3.691337395627516*^9}, {
   3.691337509977026*^9, 3.6913375538157597`*^9}, {3.691337613138473*^9, 
   3.691337613360076*^9}, {3.691337647078801*^9, 3.691337659459524*^9}, {
   3.6913377369577217`*^9, 3.691337761411985*^9}, {3.6913378017077*^9, 
   3.691337807443638*^9}, {3.6913378483419113`*^9, 3.6913378692068253`*^9}, {
   3.691337970846335*^9, 3.691337981830944*^9}, {3.691338099264483*^9, 
   3.69133815173046*^9}, {3.691338216927093*^9, 3.691338230388547*^9}, {
   3.691338288006468*^9, 3.691338370259178*^9}, {3.691338448495356*^9, 
   3.691338501190292*^9}, {3.6913385317620564`*^9, 3.691338544622998*^9}, {
   3.691411091420906*^9, 3.691411144253314*^9}, {3.691411289120596*^9, 
   3.69141130590405*^9}}]
},
WindowSize->{1920, 1052},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
FrontEndVersion->"10.0 for Linux x86 (64-bit) (June 27, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 34726, 908, 2915, "Input"]
}
]
*)

(* End of internal cache information *)
