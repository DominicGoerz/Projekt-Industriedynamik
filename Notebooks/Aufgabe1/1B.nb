(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     54528,       1426]
NotebookOptionsPosition[     54218,       1410]
NotebookOutlinePosition[     54552,       1425]
CellTagsIndexPosition[     54509,       1422]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"LOAD", " ", "FUNCTIONS"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", 
   RowBox[{"FindFile", "[", "\"\<../MyFunctions.m\>\"", "]"}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", "FIXED"}]}], " ", 
    RowBox[{"STRATEGIES", ":", " ", 
     RowBox[{
      RowBox[{
      "First", " ", "half", " ", "of", " ", "firms", " ", "buys", " ", "the", 
       " ", "smart", " ", "part", " ", "while", " ", "the", " ", "other", " ",
        "half", " ", "produces", " ", "the", " ", "smart", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"part", " ", "!"}], "--"}], "--"}], "--"}], "--"}],
                "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
        "--"}]}], "-"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}], "*)"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"INIITIALIZE", " ", "PARAMETERS"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"\[Alpha]", " ", "=", " ", "0.5"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"\[Beta]", " ", "=", " ", "1.0"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"\[Delta]", " ", "=", " ", "0.5"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"\[Kappa]", " ", "=", " ", "5"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"\[Chi]", " ", "=", " ", "0.1"}], ";"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"\[Eta]", " ", "=", " ", "0.25"}], ";"}]}], "\[IndentingNewLine]", 

 RowBox[{"\t", 
  RowBox[{
   RowBox[{"etaBar", "=", " ", "0.5"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"uBar", " ", "=", " ", "1.0"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"cp", " ", "=", " ", "20.0"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"cs", " ", "=", " ", "10.0"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Number", " ", "of", " ", "firms"}], "*)"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"n", "=", "10"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"d", "=", 
    RowBox[{"Round", "[", 
     RowBox[{"n", "/", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "A", " ", "dummy", " ", "vector", " ", "used", " ", "to", " ", "identify",
      " ", "each", " ", "firm", " ", "by", " ", "a", " ", "certain", " ", 
     RowBox[{"number", ":", 
      RowBox[{"1", "-", 
       RowBox[{"first", " ", "firm"}]}]}]}], ",", 
    RowBox[{"2", "-", 
     RowBox[{"second", " ", "firm"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"...", ".."}], "n"}], "-", 
     RowBox[{"nth", " ", "firm"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"Id", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"i", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"Number", " ", "of", " ", "consumers"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"m", "=", "100"}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"Number", " ", "of", " ", "bartch", " ", "runs"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"R", "=", "20"}], ";"}], " ", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Number", " ", "of", " ", "time", " ", "periods"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"T", "=", "100"}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Wanna", " ", "have", " ", 
    RowBox[{"plots", "?"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"plots", "=", "True"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Wanna", " ", "have", " ", 
    RowBox[{"tables", "?"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"tables", " ", "=", "True"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "define", " ", "start", " ", "and", " ", "end", " ", "of", " ", "time", 
    " ", "period", " ", "you", " ", "want", " ", "to", " ", "consider"}], 
   "*)"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"start", "=", "1"}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"lend", "=", "20"}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{"length", " ", "of", " ", "table"}], "*)"}], "\n", "\t", 
   RowBox[{"pend", "=", "20"}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{"plot", " ", "horizon"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "firms", " ", "making", " ", "positive", " ", "profits", " ", "at", " ", 
     "T", " ", "for", " ", "each", " ", "batch", " ", "run"}], "*)"}], 
   "\[IndentingNewLine]", "\t", 
   RowBox[{"survivor", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0.0", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "1", ",", "R"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "how", " ", "many", " ", "firms", " ", "make", " ", "positive", " ", 
    "profits", " ", "at", " ", 
    RowBox[{"T", "?"}]}], "*)"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"numFirmsSurvive", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0.0", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "1", ",", "R"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"-", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"-", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"MAIN", " ", "--"}], "--"}], "--"}], 
                    "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "-", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"-", 
         RowBox[{"-", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"-", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Timing", "[", "\n", 
   RowBox[{"(*", 
    RowBox[{"BATCH", " ", "RUNS"}], "*)"}], "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{
    "Do", "[", "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"-", " ", "INITIALIZE"}]}]}], " ", "LISTS", " ", "FOR", " ",
         "EACH", " ", "BATCH", " ", 
        RowBox[{
         RowBox[{"RUN", " ", "--"}], "--"}]}], "-"}], "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", "prices", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"priceListFirm", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"priceSpec", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"period", " ", "quantities"}], "*)"}], "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"quantPeriodFirm", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"quantPeriodSpec", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"aggregated", " ", "quantities"}], "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"quantAggSpec", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"quantAggFirm", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"market", " ", "share"}], "*)"}], "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"msSpec", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"markup", " ", "of", " ", "specialist"}], "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"\[Eta]Spec", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", "quality", "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{"qualityList", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", "probabilities", "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{"probList", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", "profits", "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{"profitListFirm", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}], "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"-", " ", "FIRST"}]}]}]}]}]}]}]}]}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"PERIOD", " ", "--"}], "--"}], "--"}], "--"}]}], "-", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", "--"}]}]}]}]}], "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"t", "=", "1"}], ";", "\t", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"quantAggFirm", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"firm", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"quantAggSpec", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "=", "0.0"}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"\[Eta]Spec", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "=", "0.0"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"compute", " ", "price", " ", "of", " ", "specialist"}], 
        "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"priceSpec", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "=", 
        RowBox[{"PriceSpec", "[", 
         RowBox[{"cs", ",", 
          RowBox[{"\[Eta]Spec", "[", 
           RowBox[{"[", "t", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"compute", " ", "prices"}], "*)"}], "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"priceListFirm", "[", 
           RowBox[{"[", 
            RowBox[{"t", ",", "firm"}], "]"}], "]"}], "=", 
          RowBox[{"PriceFirmSpec", "[", 
           RowBox[{"cp", ",", "cs", ",", "\[Eta]", ",", 
            RowBox[{"\[Eta]Spec", "[", 
             RowBox[{"[", "t", "]"}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"{", 
          RowBox[{"firm", ",", "1", ",", "d"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"priceListFirm", "[", 
           RowBox[{"[", 
            RowBox[{"t", ",", "firm"}], "]"}], "]"}], "=", 
          RowBox[{"PriceFirmSelf", "[", 
           RowBox[{"cp", ",", "cs", ",", "\[Eta]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"{", 
          RowBox[{"firm", ",", 
           RowBox[{"d", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"compute", " ", "qualities"}], "*)"}], "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"qualityList", "[", 
           RowBox[{"[", 
            RowBox[{"t", ",", "firm"}], "]"}], "]"}], "=", 
          RowBox[{"QualityFirmSpec", "[", 
           RowBox[{"uBar", ",", "\[Alpha]", ",", "\[Beta]", ",", 
            RowBox[{"quantAggSpec", "[", 
             RowBox[{"[", "t", "]"}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"{", 
          RowBox[{"firm", ",", "1", ",", "d"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"qualityList", "[", 
           RowBox[{"[", 
            RowBox[{"t", ",", "firm"}], "]"}], "]"}], "=", 
          RowBox[{"QualityFirmSelf", "[", 
           RowBox[{"uBar", ",", "\[Alpha]", ",", "\[Beta]", ",", 
            RowBox[{"quantAggFirm", "[", 
             RowBox[{"[", 
              RowBox[{"t", ",", "firm"}], "]"}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"{", 
          RowBox[{"firm", ",", 
           RowBox[{"d", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"compute", " ", "probabilities"}], "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"probList", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
         RowBox[{
          RowBox[{"Prob", "[", 
           RowBox[{"firm", ",", 
            RowBox[{"priceListFirm", "[", 
             RowBox[{"[", "t", "]"}], "]"}], ",", 
            RowBox[{"qualityList", "[", 
             RowBox[{"[", "t", "]"}], "]"}], ",", "\[Kappa]", ",", "\[Chi]"}],
            "]"}], ",", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"firm", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"compute", " ", "demand"}], "*)"}], "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"choices", "=", 
        RowBox[{"RandomChoice", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"probList", "[", 
            RowBox[{"[", "t", "]"}], "]"}], "\[Rule]", "Id"}], ",", "m"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"compute", " ", "period", " ", "output"}], "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"quantPeriodFirm", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{"choices", ",", "firm"}], "]"}], ",", 
          "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"firm", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"quantPeriodSpec", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"quantPeriodFirm", "[", 
           RowBox[{"[", 
            RowBox[{"t", ",", "firm"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"firm", ",", "1", ",", "d"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"compute", " ", "market", " ", "share"}], "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"msSpec", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "=", 
        RowBox[{"MarketShare", "[", 
         RowBox[{
          RowBox[{"quantPeriodSpec", "[", 
           RowBox[{"[", "t", "]"}], "]"}], ",", "quantPeriodFirm"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"compute", " ", "profits"}], "*)"}], "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"profitListFirm", "[", 
           RowBox[{"[", 
            RowBox[{"t", ",", "firm"}], "]"}], "]"}], "=", 
          RowBox[{"ProfitFirmSpec", "[", 
           RowBox[{
            RowBox[{"quantPeriodFirm", "[", 
             RowBox[{"[", 
              RowBox[{"t", ",", "firm"}], "]"}], "]"}], ",", "cp", ",", "cs", 
            ",", "\[Eta]", ",", 
            RowBox[{"\[Eta]Spec", "[", 
             RowBox[{"[", "t", "]"}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"{", 
          RowBox[{"firm", ",", "1", ",", "d"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"profitListFirm", "[", 
           RowBox[{"[", 
            RowBox[{"t", ",", "firm"}], "]"}], "]"}], "=", 
          RowBox[{"ProfitFirmSelf", "[", 
           RowBox[{
            RowBox[{"quantPeriodFirm", "[", 
             RowBox[{"[", 
              RowBox[{"t", ",", "firm"}], "]"}], "]"}], ",", "cp", ",", "cs", 
            ",", "\[Eta]"}], "]"}]}], ",", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"{", 
          RowBox[{"firm", ",", 
           RowBox[{"d", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}], "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"-", " ", "PERIODS"}]}]}]}]}]}]}]}]}], " ", "2"}], 
         "-", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"T", " ", "--"}], "--"}], "--"}], "--"}], "-", 
         RowBox[{"-", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", "--"}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}], "*)"}], "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", 
         RowBox[{
         "compute", " ", "aggregated", " ", "quantities", " ", "for", " ", 
          "each", " ", "firm"}], "*)"}], "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"quantAggFirm", "[", 
            RowBox[{"[", "t", "]"}], "]"}], "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"quantAggFirm", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"t", "-", "1"}], ",", "firm"}], "]"}], "]"}], "+", 
              RowBox[{"quantPeriodFirm", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"t", "-", "1"}], ",", "firm"}], "]"}], "]"}]}], ",", 
             "\[IndentingNewLine]", "\t\t\t\t\t\t", 
             RowBox[{"{", 
              RowBox[{"firm", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{
           "compute", " ", "aggregated", " ", "quantities", " ", "of", " ", 
            "specialist"}], "*)"}], "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"quantAggSpec", "[", 
            RowBox[{"[", "t", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"quantAggSpec", "[", 
             RowBox[{"[", 
              RowBox[{"t", "-", "1"}], "]"}], "]"}], "+", 
            RowBox[{"quantPeriodSpec", "[", 
             RowBox[{"[", 
              RowBox[{"t", "-", "1"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{"compute", " ", "markup"}], "*)"}], "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{
           RowBox[{"\[Eta]Spec", "[", 
            RowBox[{"[", "t", "]"}], "]"}], "=", 
           RowBox[{"MarkupSpec", "[", 
            RowBox[{"\[Delta]", ",", 
             RowBox[{"\[Eta]Spec", "[", 
              RowBox[{"[", 
               RowBox[{"t", "-", "1"}], "]"}], "]"}], ",", 
             RowBox[{"msSpec", "[", 
              RowBox[{"[", 
               RowBox[{"t", "-", "1"}], "]"}], "]"}], ",", "etaBar"}], " ", 
            "]"}]}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{"compute", " ", "price", " ", "of", " ", "specialist"}], 
           "*)"}], "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"priceSpec", "[", 
            RowBox[{"[", "t", "]"}], "]"}], "=", 
           RowBox[{"PriceSpec", "[", 
            RowBox[{"cs", ",", 
             RowBox[{"\[Eta]Spec", "[", 
              RowBox[{"[", "t", "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{"compute", " ", "prices"}], "*)"}], "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"priceListFirm", "[", 
              RowBox[{"[", 
               RowBox[{"t", ",", "firm"}], "]"}], "]"}], "=", 
             RowBox[{"PriceFirmSpec", "[", 
              RowBox[{"cp", ",", "cs", ",", "\[Eta]", ",", 
               RowBox[{"\[Eta]Spec", "[", 
                RowBox[{"[", "t", "]"}], "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"{", 
             RowBox[{"firm", ",", "1", ",", "d"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"priceListFirm", "[", 
              RowBox[{"[", 
               RowBox[{"t", ",", "firm"}], "]"}], "]"}], "=", 
             RowBox[{"PriceFirmSelf", "[", 
              RowBox[{"cp", ",", "cs", ",", "\[Eta]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"{", 
             RowBox[{"firm", ",", 
              RowBox[{"d", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{"compute", " ", "qualities"}], "*)"}], 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"qualityList", "[", 
              RowBox[{"[", 
               RowBox[{"t", ",", "firm"}], "]"}], "]"}], "=", 
             RowBox[{"QualityFirmSpec", "[", 
              RowBox[{"uBar", ",", "\[Alpha]", ",", "\[Beta]", ",", 
               RowBox[{"quantAggSpec", "[", 
                RowBox[{"[", "t", "]"}], "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"{", 
             RowBox[{"firm", ",", "1", ",", "d"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"qualityList", "[", 
              RowBox[{"[", 
               RowBox[{"t", ",", "firm"}], "]"}], "]"}], "=", 
             RowBox[{"QualityFirmSelf", "[", 
              RowBox[{"uBar", ",", "\[Alpha]", ",", "\[Beta]", ",", 
               RowBox[{"quantAggFirm", "[", 
                RowBox[{"[", 
                 RowBox[{"t", ",", "firm"}], "]"}], "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"{", 
             RowBox[{"firm", ",", 
              RowBox[{"d", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{"compute", " ", "probabilities"}], "*)"}], 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"probList", "[", 
            RowBox[{"[", "t", "]"}], "]"}], "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Prob", "[", 
              RowBox[{"firm", ",", 
               RowBox[{"priceListFirm", "[", 
                RowBox[{"[", "t", "]"}], "]"}], ",", 
               RowBox[{"qualityList", "[", 
                RowBox[{"[", "t", "]"}], "]"}], ",", "\[Kappa]", ",", 
               "\[Chi]"}], "]"}], ",", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
             
             RowBox[{"{", 
              RowBox[{"firm", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{"compute", " ", "demand"}], "*)"}], "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"choices", "=", 
           RowBox[{"RandomChoice", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"probList", "[", 
               RowBox[{"[", "t", "]"}], "]"}], "\[Rule]", "Id"}], ",", "m"}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{"compute", " ", "period", " ", "output"}], "*)"}], 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"quantPeriodFirm", "[", 
            RowBox[{"[", "t", "]"}], "]"}], "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Count", "[", 
              RowBox[{"choices", ",", "firm"}], "]"}], ",", 
             "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
             RowBox[{"{", 
              RowBox[{"firm", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"quantPeriodSpec", "[", 
            RowBox[{"[", "t", "]"}], "]"}], "=", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"quantPeriodFirm", "[", 
              RowBox[{"[", 
               RowBox[{"t", ",", "firm"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"firm", ",", "1", ",", "d"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{"compute", " ", "market", " ", "share"}], "*)"}], 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"msSpec", "[", 
            RowBox[{"[", "t", "]"}], "]"}], "=", 
           RowBox[{"MarketShare", "[", 
            RowBox[{
             RowBox[{"quantPeriodSpec", "[", 
              RowBox[{"[", "t", "]"}], "]"}], ",", "quantPeriodFirm"}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{"compute", " ", "profits"}], "*)"}], "\[IndentingNewLine]",
           "\t\t", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"profitListFirm", "[", 
              RowBox[{"[", 
               RowBox[{"t", ",", "firm"}], "]"}], "]"}], "=", 
             RowBox[{"ProfitFirmSpec", "[", 
              RowBox[{
               RowBox[{"quantPeriodFirm", "[", 
                RowBox[{"[", 
                 RowBox[{"t", ",", "firm"}], "]"}], "]"}], ",", "cp", ",", 
               "cs", ",", "\[Eta]", ",", 
               RowBox[{"\[Eta]Spec", "[", 
                RowBox[{"[", "t", "]"}], "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"{", 
             RowBox[{"firm", ",", "1", ",", "d"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"profitListFirm", "[", 
              RowBox[{"[", 
               RowBox[{"t", ",", "firm"}], "]"}], "]"}], "=", 
             RowBox[{"ProfitFirmSelf", "[", 
              RowBox[{
               RowBox[{"quantPeriodFirm", "[", 
                RowBox[{"[", 
                 RowBox[{"t", ",", "firm"}], "]"}], "]"}], ",", "cp", ",", 
               "cs", ",", "\[Eta]"}], "]"}]}], ",", "\[IndentingNewLine]", 
            "\t\t", 
            RowBox[{"{", 
             RowBox[{"firm", ",", 
              RowBox[{"d", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{"compute", " ", "statistic"}], "*)"}], 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"t", "\[Equal]", "T"}], ",", "\[IndentingNewLine]", 
            "\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"numFirmsSurvive", "[", 
               RowBox[{"[", "r", "]"}], "]"}], "=", 
              RowBox[{"Count", "[", 
               RowBox[{
                RowBox[{"profitListFirm", "[", 
                 RowBox[{"[", "t", "]"}], "]"}], ",", 
                RowBox[{"u_", "/;", 
                 RowBox[{"u", ">", "0"}]}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"survivor", "[", 
               RowBox[{"[", "r", "]"}], "]"}], "=", 
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"profitListFirm", "[", 
                 RowBox[{"[", "t", "]"}], "]"}], ",", 
                RowBox[{"u_", "/;", 
                 RowBox[{"u", ">", "0"}]}]}], "]"}]}]}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"t", ",", "2", ",", "T"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"r", ",", "1", ",", "R"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", "LOAD"}]}]}]}]}]}]}]}]}]}], " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"RESULTS", "--"}], "--"}], "--"}], "--"}], "--"}], "--"}],
        "--"}], "--"}], "--"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"results1B", "=", 
   RowBox[{"NotebookOpen", "[", 
    RowBox[{"FindFile", "[", "\"\<results1B.nb\>\"", "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"SelectionMove", "[", 
   RowBox[{"results1B", ",", "All", ",", "Notebook"}], "]"}], ";", 
  RowBox[{"SelectionEvaluate", "[", "results1B", "]"}]}]}], "Input",
 CellChangeTimes->{{3.690534047656938*^9, 3.690534047661303*^9}, 
   3.690699983118863*^9, {3.690700017760223*^9, 3.690700069943945*^9}, {
   3.690700338860899*^9, 3.6907003614554157`*^9}, {3.690700476560109*^9, 
   3.690700523494061*^9}, 3.690700716772827*^9, 3.690700791039661*^9, {
   3.690700851583761*^9, 3.690700868294778*^9}, {3.690700956526722*^9, 
   3.690700984328312*^9}, {3.690701015425622*^9, 3.6907010703560057`*^9}, {
   3.691246187460534*^9, 3.691246188172669*^9}, {3.691246809713402*^9, 
   3.691246809859095*^9}, {3.691246890517591*^9, 3.691246891701644*^9}, {
   3.691296762931116*^9, 3.69129699249184*^9}, {3.6912970257407913`*^9, 
   3.6912971239385767`*^9}, {3.69129729332128*^9, 3.691297366414281*^9}, {
   3.691297601683998*^9, 3.691297620832473*^9}, 3.6912979049910297`*^9, {
   3.691297936193959*^9, 3.691297960257174*^9}, {3.691298027841878*^9, 
   3.691298113921686*^9}, {3.691298166018724*^9, 3.6912982566516237`*^9}, {
   3.691298313481855*^9, 3.691298342690858*^9}, {3.691298456796319*^9, 
   3.691298602954219*^9}, {3.691315762056528*^9, 3.691315762583529*^9}, 
   3.691315855043695*^9, {3.691315891907493*^9, 3.691315911729705*^9}, 
   3.69131602025391*^9, {3.691316053606909*^9, 3.691316151109002*^9}, {
   3.691316206387377*^9, 3.6913162482892027`*^9}, {3.691316408575931*^9, 
   3.691316418296173*^9}, {3.691334139693364*^9, 3.6913341528794403`*^9}, {
   3.6913341915740643`*^9, 3.691334231475933*^9}, {3.691334261747781*^9, 
   3.6913342801565723`*^9}, {3.691335799200159*^9, 3.6913359275498667`*^9}, {
   3.691335965385607*^9, 3.691335967636325*^9}, {3.691336007990614*^9, 
   3.6913360086354856`*^9}, {3.691336058723813*^9, 3.691336058913426*^9}, {
   3.6913361075518713`*^9, 3.691336109372498*^9}, {3.6913361711746893`*^9, 
   3.6913361934755697`*^9}, {3.691336252895183*^9, 3.691336359295199*^9}, {
   3.691336465278316*^9, 3.6913365056800737`*^9}, {3.691336558597044*^9, 
   3.691336574726509*^9}, {3.6913366171405697`*^9, 3.691336619363077*^9}, {
   3.691336674561841*^9, 3.6913366752717857`*^9}, {3.691336775173295*^9, 
   3.691336776138653*^9}, {3.691337357981628*^9, 3.691337395627516*^9}, {
   3.691337509977026*^9, 3.6913375538157597`*^9}, {3.691337613138473*^9, 
   3.691337613360076*^9}, {3.691337647078801*^9, 3.691337659459524*^9}, {
   3.6913377369577217`*^9, 3.691337761411985*^9}, {3.6913378017077*^9, 
   3.691337807443638*^9}, {3.6913378483419113`*^9, 3.6913378692068253`*^9}, {
   3.691337970846335*^9, 3.691337981830944*^9}, {3.691338099264483*^9, 
   3.69133815173046*^9}, {3.691338216927093*^9, 3.691338230388547*^9}, {
   3.691338288006468*^9, 3.691338370259178*^9}, {3.691338448495356*^9, 
   3.691338501190292*^9}, {3.6913385317620564`*^9, 3.691338544622998*^9}, {
   3.691411091420906*^9, 3.691411144253314*^9}, {3.691411289120596*^9, 
   3.69141130590405*^9}, {3.692529615694449*^9, 3.6925296244593287`*^9}, {
   3.6925296762696657`*^9, 3.6925297899659224`*^9}, {3.692529828170879*^9, 
   3.692529857055245*^9}, {3.692529971033778*^9, 3.6925299943440237`*^9}, {
   3.692530042551586*^9, 3.692530088111773*^9}, {3.692530138672714*^9, 
   3.692530162202902*^9}, {3.692530210421206*^9, 3.692530298409671*^9}, {
   3.692530365259068*^9, 3.692530424212237*^9}, {3.6925305252169857`*^9, 
   3.6925305302687883`*^9}, {3.692530585628168*^9, 3.692530591316556*^9}, {
   3.6925321569799232`*^9, 3.692532176766864*^9}, {3.692532447201942*^9, 
   3.692532450379058*^9}, {3.692532560538681*^9, 3.692532571376993*^9}, {
   3.692533046201313*^9, 3.6925330498167067`*^9}, {3.692533090915704*^9, 
   3.6925330948022327`*^9}, {3.692533988283888*^9, 3.692534049091723*^9}, {
   3.692534091995829*^9, 3.692534109910499*^9}, {3.692534759643433*^9, 
   3.6925348014566803`*^9}, {3.6925354121847773`*^9, 3.692535432096834*^9}, {
   3.692535491545142*^9, 3.6925355127562103`*^9}, {3.692535774749992*^9, 
   3.692535778722549*^9}, {3.692535816199669*^9, 3.692535827287858*^9}, {
   3.69253592770617*^9, 3.692535955160119*^9}, {3.692535997134804*^9, 
   3.692536024555374*^9}, {3.692536080209071*^9, 3.692536166369869*^9}, {
   3.6925362539295387`*^9, 3.6925364649837837`*^9}, {3.692536550377304*^9, 
   3.692536579557678*^9}, {3.692536652632653*^9, 3.692536659922151*^9}, {
   3.692537685489957*^9, 3.692538028632929*^9}, {3.692538090805458*^9, 
   3.692538161121139*^9}, {3.692538395124296*^9, 3.692538437289572*^9}, {
   3.692538482153432*^9, 3.692538528539785*^9}, {3.6925386093017197`*^9, 
   3.692538758573682*^9}, {3.69253880139953*^9, 3.692538850801271*^9}, {
   3.692538898943791*^9, 3.692538948483286*^9}, {3.692539005711359*^9, 
   3.692539036070594*^9}, {3.692539071388047*^9, 3.692539076416655*^9}, {
   3.692539168436758*^9, 3.6925391820649242`*^9}, {3.692539214042612*^9, 
   3.692539282112764*^9}, {3.692539360525302*^9, 3.6925393713904047`*^9}, {
   3.69253942283424*^9, 3.692539441259741*^9}, {3.692539591012352*^9, 
   3.692539620104601*^9}, {3.6925407024077797`*^9, 3.692540710872758*^9}, {
   3.692540824433783*^9, 3.6925408687780943`*^9}, {3.6925411232545023`*^9, 
   3.692541145188032*^9}, {3.692544421816448*^9, 3.692544426822248*^9}, {
   3.692546042699382*^9, 3.6925460715506563`*^9}, {3.69259866777162*^9, 
   3.6925986901485033`*^9}, {3.692602984393223*^9, 3.692603006646813*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.42399999999999993249844010279048234224`6.174109902580462", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{3.692538186815815*^9, 3.6925391341018467`*^9, 
  3.692539327099927*^9, 3.6925393843195457`*^9, 3.692539557573925*^9, 
  3.692540890326302*^9, 3.692541160373898*^9, 3.69254601585858*^9, 
  3.692598693550194*^9, 3.692603011467911*^9}]
}, Open  ]]
},
WindowSize->{1920, 1052},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
FrontEndVersion->"10.0 for Linux x86 (64-bit) (June 27, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 53228, 1375, 4499, "Input"],
Cell[53811, 1399, 391, 8, 32, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
