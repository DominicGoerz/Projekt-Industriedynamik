(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11112,        227]
NotebookOptionsPosition[     10838,        213]
NotebookOutlinePosition[     11212,        229]
CellTagsIndexPosition[     11169,        226]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", " ", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fn", "=", " ", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"friendsList", "=", 
   RowBox[{"GetFriendsList", "[", 
    RowBox[{"m", ",", "fn"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kappaList", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"T", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"friendsQuality", "=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"T", ",", "m"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetFriendsList", "[", 
    RowBox[{"m_", ",", "fn_"}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"friendsCountList", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Min", "[", "friendsCountList", "]"}], "\[NotEqual]", "fn"}],
         "&&", " ", 
        RowBox[{
         RowBox[{"Max", "[", "friendsCountList", "]"}], "\[NotEqual]", 
         "fn"}]}], ",", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"friendsList", " ", "=", " ", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"avfriendsList", " ", "=", " ", 
          RowBox[{"Range", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"friendsCountList", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"friendsCountList", "=", 
              RowBox[{"Total", "[", 
               RowBox[{"Transpose", "[", "friendsList", "]"}], "]"}]}], ";", 
             "\t", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"smallest", "=", 
                  RowBox[{"Min", "[", "friendsCountList", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"avfriendsList", " ", "=", " ", 
                  RowBox[{"Position", "[", 
                   RowBox[{"friendsCountList", ",", " ", "smallest"}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"avfriendsList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
                    RowBox[{"{", "i", "}"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"avfriendsList", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"avfriendsList", ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}], "}"}], ",", 
                   RowBox[{"{", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"rpos", "=", " ", 
                  RowBox[{"RandomInteger", "[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"Length", "[", "avfriendsList", "]"}]}], "}"}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"friend", "=", " ", 
                  RowBox[{"avfriendsList", "[", 
                   RowBox[{"[", "rpos", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"friendsList", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "friend"}], "]"}], "]"}], "=", "1"}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"friendsList", "[", 
                   RowBox[{"[", 
                    RowBox[{"friend", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"friendsCountList", "=", 
                  RowBox[{"Total", "[", 
                   RowBox[{"Transpose", "[", "friendsList", "]"}], "]"}]}], 
                 ";"}], "\[IndentingNewLine]", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"z", ",", "1", ",", 
                 RowBox[{"fn", "-", 
                  RowBox[{"friendsCountList", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], "]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "m"}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "friendsList"}], "}"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6929775708628254`*^9, 3.6929776195189915`*^9}, {
   3.692977665398469*^9, 3.6929777050816517`*^9}, {3.693109034634097*^9, 
   3.6931091352167263`*^9}, {3.693109793363393*^9, 3.6931097953871155`*^9}, {
   3.693321198047062*^9, 3.693321787810522*^9}, {3.6933218498541484`*^9, 
   3.6933221240542526`*^9}, {3.693322175356618*^9, 3.6933222253408346`*^9}, {
   3.693322312686313*^9, 3.6933223583455763`*^9}, {3.6933224797156105`*^9, 
   3.693322498898258*^9}, {3.693322597218391*^9, 3.693322671009113*^9}, {
   3.6933227247891083`*^9, 3.693322750679657*^9}, {3.6933227867380705`*^9, 
   3.6933227868849688`*^9}, {3.693322974961254*^9, 3.693322991490542*^9}, {
   3.693323058194626*^9, 3.6933230699228444`*^9}, {3.693323362690036*^9, 
   3.6933233635594373`*^9}, {3.6933233979388514`*^9, 
   3.6933234055237703`*^9}, {3.6933235226828384`*^9, 
   3.6933236065528975`*^9}, {3.6933237372880974`*^9, 
   3.6933237378173466`*^9}, {3.6933239276369133`*^9, 3.693323957496676*^9}, {
   3.693324034098584*^9, 3.6933241212331743`*^9}, {3.6933241764732337`*^9, 
   3.6933242058072453`*^9}, {3.6933242519314556`*^9, 
   3.6933242817107754`*^9}, {3.693324360247575*^9, 3.693324361001861*^9}, {
   3.6933243945180764`*^9, 3.693324409395582*^9}, {3.6933245103510504`*^9, 
   3.69332453657957*^9}, {3.6933247276683764`*^9, 3.693324815017*^9}, {
   3.6933248646770973`*^9, 3.693324914220419*^9}, {3.6933249574383273`*^9, 
   3.6933249584704847`*^9}, 3.693324993024695*^9, {3.6933250748917913`*^9, 
   3.6933251474826937`*^9}, {3.693325179462674*^9, 3.693325209132821*^9}, {
   3.693325239792719*^9, 3.693325297651579*^9}, {3.6933253421221075`*^9, 
   3.6933253834673853`*^9}, {3.6933254312539716`*^9, 3.6933254362595215`*^9}, 
   3.693325480582429*^9, {3.6933255348787556`*^9, 3.6933255704970937`*^9}, {
   3.6933256014367504`*^9, 3.6933256156635475`*^9}, {3.6933256467786727`*^9, 
   3.693325700332573*^9}, {3.6933257537897687`*^9, 3.693325772927932*^9}, {
   3.693325833382087*^9, 3.6933258705732455`*^9}, {3.6933871023216457`*^9, 
   3.6933871025871706`*^9}, 3.693387146618272*^9, {3.6933871861495247`*^9, 
   3.693387200962432*^9}, {3.693387253897745*^9, 3.6933872699632654`*^9}, {
   3.6933885070733604`*^9, 3.693388598568691*^9}, {3.6933886626281843`*^9, 
   3.693388799071246*^9}, {3.6933888713318367`*^9, 3.693388877932886*^9}, {
   3.693389048786167*^9, 3.6933891088787713`*^9}, {3.69338922263899*^9, 
   3.693389235966316*^9}, {3.6933892957544823`*^9, 3.6933893571066628`*^9}, {
   3.6933894624937954`*^9, 3.693389464541765*^9}, {3.6933897099120045`*^9, 
   3.693389839003251*^9}, {3.6933902633285627`*^9, 3.693390316979865*^9}, {
   3.6933903676795444`*^9, 3.6933903689960065`*^9}, {3.6933904447435617`*^9, 
   3.693390445329122*^9}, 3.693473712601569*^9, {3.69347381845938*^9, 
   3.693473829434785*^9}, {3.6934739303625293`*^9, 3.6934740383305717`*^9}, {
   3.6934741799339585`*^9, 3.693474183321451*^9}, {3.6934742677170715`*^9, 
   3.693474301752775*^9}, {3.6934756813208485`*^9, 3.6934756852019672`*^9}, {
   3.693475866646278*^9, 3.693475895589629*^9}, {3.6934760345159793`*^9, 
   3.6934760579894133`*^9}, {3.6934761101580086`*^9, 
   3.6934761207530475`*^9}, {3.693476168541519*^9, 3.6934762215833874`*^9}, {
   3.693476321934736*^9, 3.6934763228324323`*^9}, {3.6934763557015977`*^9, 
   3.6934763559867954`*^9}, 3.693476401323846*^9, 3.693476482446352*^9, {
   3.6934766745663395`*^9, 3.693476795863068*^9}, {3.6934776442671013`*^9, 
   3.6934777343998494`*^9}, {3.69347778162749*^9, 3.69347781112146*^9}, {
   3.6934778463558826`*^9, 3.6934778796530294`*^9}, {3.6934779123160653`*^9, 
   3.6934779206048937`*^9}, {3.693477960534954*^9, 3.693478013564433*^9}, {
   3.693478067827901*^9, 3.6934780702846136`*^9}, {3.6934781260385594`*^9, 
   3.6934781381355257`*^9}, {3.6934781700741343`*^9, 3.693478187178438*^9}, {
   3.6934782547234554`*^9, 3.693478304898836*^9}, {3.69347836480742*^9, 
   3.693478420481351*^9}, {3.693478452535866*^9, 3.6934785492433662`*^9}, {
   3.6934787484872103`*^9, 3.6934787744588294`*^9}, {3.6934788137555003`*^9, 
   3.6934788233961186`*^9}, {3.693478880599699*^9, 3.693478933983812*^9}, {
   3.6934791171943617`*^9, 3.6934791675352187`*^9}, {3.69347931714827*^9, 
   3.693479374151246*^9}, {3.6934794286760225`*^9, 3.693479492470945*^9}, {
   3.693479525736617*^9, 3.6934795488349767`*^9}, {3.693479798399067*^9, 
   3.6934799088195767`*^9}, {3.6934799896589146`*^9, 
   3.6934800221966095`*^9}, {3.6934800840066404`*^9, 3.693480213249366*^9}, {
   3.693480254746909*^9, 3.6934802639011555`*^9}, {3.6934803013595123`*^9, 
   3.6934803314696627`*^9}, {3.6934803793435802`*^9, 3.693480397970378*^9}, {
   3.6934804475770116`*^9, 3.6934804503031073`*^9}, {3.693480869586814*^9, 
   3.6934809053134003`*^9}, {3.693482248338505*^9, 3.6934823422945013`*^9}, {
   3.693482373408162*^9, 3.6934824017646666`*^9}, {3.693483089890259*^9, 
   3.693483090675679*^9}}]
},
WindowSize->{1350, 685},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
Magnification:>0.8 Inherited,
FrontEndVersion->"10.3 for Microsoft Windows (64-bit) (October 9, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 10276, 191, 655, "Input"]
}
]
*)

(* End of internal cache information *)
